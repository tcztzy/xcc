# TODO

This file tracks remaining work toward a production-ready C11 compiler. It includes both frontend and backend scope, but only the frontend section is expanded for now.

## 0. Milestone View

- [ ] M0: Complete C11 frontend conformance baseline.
- [ ] M1: Add minimal IR and code generation for macOS arm64.
- [ ] M2: Add Linux/ELF backend path (mold + glibc/musl).
- [ ] M3: Compile CPython core with no source modifications.
- [ ] M4: Harden diagnostics, compatibility, and performance.

## 1. Frontend (Expanded)

### 1.1 Preprocessor Conformance

- [ ] Close remaining C11 edge cases for macro replacement order and rescanning behavior.
- [x] Iteration 3: tighten conditional expression evaluation parity for `#if` / `#elif` boolean short-circuit corner cases.
- [x] Add `__has_include("...")` / `__has_include(<...>)` conditional support with regression tests.
- [ ] Expand include behavior coverage (path search precedence, diagnostics consistency, mapping interaction).
- [ ] Validate predefined macro behavior against C11 and target assumptions.
- [ ] Add curated fixture cases for every preprocessor diagnostic path.

### 1.2 Lexer Completeness

- [ ] Audit tokenization parity for all C11 literal forms and suffix combinations.
- [ ] Tighten UCN/escape handling in edge cases and ensure diagnostic stability.
- [ ] Expand tests for translation phases interaction (trigraphs + line splicing + comments + literals).
- [ ] Ensure strict/gnu mode split is consistent for extension-sensitive tokens.

### 1.3 Parser Grammar Coverage

- [ ] Remove remaining "unsupported" declarator/array-size parse paths where C11 requires support.
- [ ] Finish full declarator coverage for function pointers, parameter arrays, qualifiers, and nested forms.
- [ ] Complete initialization grammar parity (designators, nested initializer lists, mixed forms).
- [ ] Validate all statement/expression grammar branches against curated fixture corpus.
- [ ] Add targeted negative tests for grammar ambiguity and recovery diagnostics.

### 1.4 Type System Model

- [ ] Implement first-class qualifier model (top-level vs nested qualifiers across all derived types).
- [ ] Complete atomic/qualified/derived type composition rules.
- [ ] Ensure complete/incomplete type transitions are modeled consistently (records, arrays, enums).
- [ ] Normalize type identity/equivalence rules used by parser, sema, and `_Generic` selection.

### 1.5 Semantic Analysis and Conversions

- [ ] Remove remaining `Unsupported statement` / `Unsupported expression` paths by implementing required branches.
- [ ] Complete usual arithmetic conversions and integer promotions for all C11 combinations.
- [x] Iteration 1: align compound-assignment conversion rules with C11 arithmetic/integer constraints (`+=`, `-=`, `*=`, `/=`, `%=` and bit/shift assigns).
- [x] Iteration 2: tighten pointer compatibility for subtraction/relational operations across qualified compatible pointee types and reject `void*` arithmetic.
- [x] Iteration 2b: tighten assignment/equality/conditional/call-pointer conversions for nested qualifier mismatches (e.g. `int **` vs `const int **`).
- [ ] Tighten pointer compatibility/conversion rules (assignment, conditional, equality, call arguments).
- [ ] Complete assignment and initialization constraint checks for all object categories.
- [ ] Finish storage-duration/linkage/storage-class rule enforcement (`extern`/`static`/`_Thread_local`, etc.).
- [ ] Expand control-flow validation (`goto` labels, switch/case constraints, function-scope interactions).
- [ ] Verify constant-expression evaluator against enum, case label, and static assertion requirements.

### 1.6 Declarations and Objects

- [ ] Complete `_Alignas` / `_Alignof` rule handling across declaration contexts.
- [ ] Finalize `_Atomic` object/type constraints and diagnostics.
- [ ] Complete record/union member constraints and layout-relevant semantic validation.
- [ ] Ensure function declaration compatibility checks fully match C11 redeclaration rules.

### 1.7 Diagnostics Quality

- [ ] Ensure each semantic/parse/preprocessor rejection path has stable, actionable messages.
- [ ] Standardize source range and stage-tag behavior for all diagnostics.
- [ ] Add regression tests for all known high-risk diagnostics.

### 1.8 Conformance and Regression Testing

- [ ] Expand curated Clang fixture manifest with additional C11 frontend coverage.
- [ ] Add local tests for every gap where no suitable upstream fixture exists.
- [ ] Maintain 100% line + branch coverage while adding new behavior.
- [ ] Keep `tox -e py311`, `tox -e lint`, `tox -e type`, and `tox -e clang_suite` green.

### 1.9 CPython-Driven Gap Closure

- [ ] Start regular frontend-only compilation trials against selected CPython translation units.
- [ ] Record failures into categorized buckets (preprocessor, parser, sema, diagnostics).
- [ ] Convert each bucket item into reproducible unit/fixture tests before implementation.

## 2. Backend and Toolchain (Outline Only)

- [ ] Define IR shape and lowering contract from frontend typed AST.
- [ ] Implement minimal code generation for macOS arm64 object output.
- [ ] Add Mach-O emission + system linker integration.
- [ ] Add Linux/ELF emission path and mold integration.
- [ ] Validate glibc/musl workflows in Docker tox targets.
- [ ] Build backend diagnostics and debug-info strategy.

## 3. Cross-Cutting Engineering

- [ ] Preserve stdlib-only runtime dependency policy.
- [ ] Keep CPython 3.11+ and PyPy 3.11+ compatibility in CI/tox coverage.
- [ ] Track lessons learned in `LESSONS.md` for each major compiler/testing change.
- [ ] Keep docs in sync with implementation status after each milestone.

## Progress Log

- Iteration: `codex/m0-conversion-01`
- Done:
  - Iteration 3 slice: expanded LP64 predefined target-assumption coverage with boolean/pointer width and size aliases (`__BOOL_WIDTH__`, `__POINTER_WIDTH__`, `__SIZEOF_BOOL__`), added regression coverage in both standard macro expansion and CLI `-U` override paths, and updated frontend coverage docs.
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded GCC-compatible predefined atomics/synchronization macro coverage with char16/char32/wchar lock-free capability macros (`__GCC_ATOMIC_{CHAR16_T,CHAR32_T,WCHAR_T}_LOCK_FREE`), `__GCC_ATOMIC_TEST_AND_SET_TRUEVAL`, and 16-byte compare-and-swap feature probing (`__GCC_HAVE_SYNC_COMPARE_AND_SWAP_16`); added focused preprocessor regression coverage for expansion and CLI `-U` override behavior, and updated frontend coverage docs.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_atomic_and_sync_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_atomic_and_sync_macros -q` (pass).
  - Iteration 3 slice: added preprocessor `__has_warning("-W...")` support for `#if`/`#elif` feature probes, including macro-expanded operator spellings and strict operand validation (`string literal` only); recognized warning options now return `1` for a curated compatibility set (`-Wall`, `-Wextra`, `-Wpedantic`, `-Wdeprecated-declarations`) and unknown options return `0`.
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_builtin_feature_extension_and_warning_operators tests.test_preprocessor.PreprocessorTests.test_if_expression_with_macro_expanded_has_warning_operator tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_warning_rejects_non_string_operand -q` (pass).
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: repaired the local clang parser fixture corpus for static-assert expression-start diagnostics so each `parser-xcc-expr-start-*-after-static-assert` case now injects the invalid token inside `_Static_assert(<token>, "ok")` (instead of statement context forms that accidentally exercised unrelated grammar paths such as empty statements or compound statements); refreshed manifest checksum/line/column metadata for all 16 fixtures.
  - Checks: `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_expected_frontend_stage -q` (expected known unrelated failures remain: `sema-warn-absolute-value-long-long` stage mismatch and `c23-n2927-2-long-long` column mismatch).
  - Iteration 3 slice: extended sema `_Generic` association-location fallback diagnostics to format partial coordinates explicitly (`line N` / `column M`) for duplicate-default, duplicate-compatible-type, and invalid-association-type failures when only one coordinate is available from `GenericExpr.association_source_locations`; added focused sema regressions and updated frontend diagnostics coverage notes.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_duplicate_default_association_error_with_partial_location tests.test_sema.SemaTests.test_generic_selection_duplicate_type_uses_partial_association_location_fallback tests.test_sema.SemaTests.test_generic_selection_invalid_type_uses_partial_association_location_fallback -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: taught sema `_Generic` diagnostic location reporting to fall back to `GenericExpr.association_source_locations` when association `TypeSpec` nodes lack direct source coordinates, so no-match, invalid-association-type, and duplicate-compatible-type failures still include line/column context in manually constructed AST fixtures; added focused sema regression coverage and updated frontend diagnostics coverage notes.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_without_match_uses_association_location_fallback tests.test_sema.SemaTests.test_generic_selection_duplicate_type_uses_association_location_fallback tests.test_sema.SemaTests.test_generic_selection_invalid_type_uses_association_location_fallback -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: expanded predefined floating-point capability/exponent baseline macros with `__FLT|DBL|LDBL_{MIN_10_EXP,MAX_10_EXP}__`, `__FLT|DBL|LDBL_HAS_INFINITY__`, and `__FLT|DBL|LDBL_HAS_QUIET_NAN__`; added focused preprocessor regression coverage for expansion and CLI `-U` removal paths, and updated frontend coverage docs.
  - Iteration 3 slice: upgraded sema `_Generic` duplicate diagnostics to include source location for the current association when available, so duplicate-compatible-type failures now report both current and previous association coordinates and duplicate-default failures identify the duplicate default site in addition to the original default.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_typedef_alias_duplicate_compatible_type_error tests.test_sema.SemaTests.test_generic_selection_qualified_typedef_alias_duplicate_compatible_type_error tests.test_sema.SemaTests.test_generic_selection_duplicate_default_association_error_with_location -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Follow-up: continue auditing sema `_Generic` diagnostics for any remaining parser-location gaps beyond no-match/invalid-type/duplicate-compatible-type paths.
  - Iteration 3 slice: added preprocessor feature-probe operator support for `__has_builtin(...)`, `__has_feature(...)`, and `__has_extension(...)` in `#if`/`#elif` expression evaluation (including macro-expanded operator spellings), with strict operand validation (`identifier` only) and focused regression coverage for success/fallback + invalid-operand diagnostics.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_builtin_feature_and_extension_operators tests.test_preprocessor.PreprocessorTests.test_if_expression_with_macro_expanded_has_builtin_operator tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_builtin_rejects_non_identifier_operand -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined GCC-compatibility atomics/synchronization macro coverage with memory-order constants (`__ATOMIC_RELAXED`..`__ATOMIC_SEQ_CST`), lock-free capability macros (`__GCC_ATOMIC_{BOOL,CHAR,SHORT,INT,LONG,LLONG,POINTER}_LOCK_FREE`), and compare-and-swap feature macros (`__GCC_HAVE_SYNC_COMPARE_AND_SWAP_{1,2,4,8}`); added focused expansion + CLI `-U` regression tests and updated frontend coverage docs.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_atomic_and_sync_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_atomic_and_sync_macros -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: aligned sema file-scope declaration fallback diagnostics with existing unexpected-AST fallback style by marking unsupported top-level declaration nodes as internal semantic bugs (`Unsupported file-scope declaration node: <Node> (internal sema bug: unexpected AST file-scope declaration node)`), added focused sema regression coverage, and documented the fallback scope in frontend diagnostics notes.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_unsupported_file_scope_declaration_node_error -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 floating-format assumptions with decimal round-trip precision aliases and denormal support/range macros (`__FLT_DECIMAL_DIG__`, `__DBL_DECIMAL_DIG__`, `__LDBL_DECIMAL_DIG__`, `__DECIMAL_DIG__`, `__FLT_DENORM_MIN__`, `__DBL_DENORM_MIN__`, `__LDBL_DENORM_MIN__`, `__FLT_HAS_DENORM__`, `__DBL_HAS_DENORM__`, `__LDBL_HAS_DENORM__`), added focused regression coverage for both default expansion and CLI `-U` removal behavior, and updated frontend C11 coverage docs.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_floating_decimal_and_denorm_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_float_denorm_and_decimal_macros -q` (pass).
  - Iteration 3 slice: normalized parser `_Alignas(...)` operand diagnostics behind an `Invalid alignment specifier: ...` prefix while preserving reason-specific suffixes (`non-object type`, `non-ICE expression`, `non-positive`, `non-power-of-two`), aligning parse-time wording with sema/context diagnostics and clang fixture expectations.
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser.ParserTests.test_alignas_rejects_non_power_of_two_constant tests.test_parser.ParserTests.test_alignas_rejects_non_positive_constant tests.test_parser.ParserTests.test_alignas_rejects_non_ice_expression tests.test_parser.ParserTests.test_alignas_rejects_void_type_name -q` (pass).
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_expected_frontend_stage -q` (expected known unrelated failures remain: `sema-warn-absolute-value-long-long`, `c23-n2927-2-long-long`, and static-assert expression-start fixtures; `sema-alignas-c11` now matches).
  - Iteration 3 slice: hardened sema fallback diagnostics for unexpected AST nodes so unsupported statement/expression fallthroughs are reported as explicit internal-semantic bugs (instead of generic unsupported-node text), added regression assertions for both fallback paths, and documented the behavior in frontend diagnostics notes.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_unsupported_expression tests.test_sema.SemaTests.test_unsupported_statement_node -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 target-type macro coverage with missing scalar type aliases used by GCC/Clang-compatible headers (`__INTMAX_TYPE__`, `__UINTMAX_TYPE__`, `__CHAR16_TYPE__`, `__CHAR32_TYPE__`), and extended regression coverage for both standard macro expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: expanded LP64 predefined integer type assumptions with fast-width aliases (`__INT_FAST{8,16,32,64}_TYPE__`, `__UINT_FAST{8,16,32,64}_TYPE__`) so projects depending on GCC/Clang fast-family spellings preprocess consistently; added regression coverage for standard macro expansion and CLI `-U` passthrough behavior, and updated frontend coverage docs.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded curated clang parser fixture coverage for non-digraph expression-start operand diagnostics in statement-adjacent contexts by adding dedicated local fixtures for `)`/`,`/`:`/`?` after `return`, `;` after initializer `=`, and `{` after `return`; wired all six into the clang manifest with stage/message/line/column expectations and checksums.
  - Checks: `.venv/bin/python - <<'PY' ...` (targeted manifest validation for `parser-xcc-expr-start-{rparen,comma,colon,question}-after-return`, `parser-xcc-expr-start-semicolon-after-initializer`, and `parser-xcc-expr-start-lbrace-after-return`: checksum + frontend stage/message/line/column assertions; pass).
  - Iteration 3 slice: expanded predefined LP64 fixed-width integer type assumptions with GCC-style type macros (`__INT8_TYPE__`, `__INT16_TYPE__`, `__INT32_TYPE__`, `__INT64_TYPE__`, `__UINT8_TYPE__`, `__UINT16_TYPE__`, `__UINT32_TYPE__`, `__UINT64_TYPE__`) plus least-width aliases (`__INT_LEAST{8,16,32,64}_TYPE__`, `__UINT_LEAST{8,16,32,64}_TYPE__`), and extended regression coverage in both standard macro expansion and CLI `-U` override paths.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: taught preprocessor `#if`/`#elif` expression evaluation to accept C character literals (including escaped and multicharacter forms) by tokenizing and converting them into integer constant values before safe evaluation, then added focused regressions for valid literals plus invalid-escape rejection paths.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_if_expression_accepts_character_literals tests.test_preprocessor.PreprocessorTests.test_if_expression_accepts_multichar_character_literals tests.test_preprocessor.PreprocessorTests.test_if_expression_accepts_escaped_character_literals tests.test_preprocessor.PreprocessorTests.test_if_expression_rejects_invalid_character_literals -q` (pass).
  - Iteration 3 slice: aligned environment include-path parsing with GCC/Clang semantics by treating empty `CPATH`/`C_INCLUDE_PATH` entries as the current working directory, then added end-to-end preprocessor and CLI regressions for `CPATH=:` current-directory includes.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_angle_uses_current_directory_for_empty_cpath_entry tests.test_cli.CliTests.test_main_cpath_empty_entry_uses_current_directory -q` (pass).
  - Iteration 3 slice: expanded preprocessor include-diagnostic mapping coverage with focused regressions proving active `#line` remapping is preserved for both plain `#include` not-found diagnostics and GNU `#include_next` not-found diagnostics (`mapped` filename/line now asserted end-to-end in failure text and error coordinates).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_not_found_uses_line_mapped_source_location tests.test_preprocessor.PreprocessorTests.test_include_next_not_found_uses_line_mapped_source_location -q` (pass).
  - Iteration 3 slice: made sema `_Thread_local` object-declaration storage diagnostics requirement-oriented by appending explicit fix guidance (`'_Thread_local' requires 'static' or 'extern'`) for both file-scope and block-scope invalid storage-class paths, including missing block-scope storage (`'none'`).
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_invalid_thread_local_storage_class_error tests.test_sema.SemaTests.test_block_scope_thread_local_rejects_register_storage_class tests.test_sema.SemaTests.test_file_scope_thread_local_rejects_invalid_storage_class -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 long-long compatibility aliases with GCC-style macro names (`__LLONG_WIDTH__`, `__LLONG_MAX__`, `__LLONG_MIN__`, `__ULLONG_MAX__`) so projects keyed on alias spellings preprocess consistently; added regression coverage in both standard macro expansion and CLI `-U` removal behavior.
  - Iteration 3 slice: expanded predefined LP64 floating-format assumptions with epsilon and finite-range literal macros (`__FLT_EPSILON__`, `__DBL_EPSILON__`, `__LDBL_EPSILON__`, `__FLT_MIN__`, `__DBL_MIN__`, `__LDBL_MIN__`, `__FLT_MAX__`, `__DBL_MAX__`, `__LDBL_MAX__`) and added regression coverage in both standard macro expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 floating-format assumptions with radix, mantissa-width, decimal-digit, and exponent-range macro coverage (`__FLT_RADIX__`, `__FLT_MANT_DIG__`, `__DBL_MANT_DIG__`, `__LDBL_MANT_DIG__`, `__FLT_DIG__`, `__DBL_DIG__`, `__LDBL_DIG__`, `__FLT_MIN_EXP__`, `__DBL_MIN_EXP__`, `__LDBL_MIN_EXP__`, `__FLT_MAX_EXP__`, `__DBL_MAX_EXP__`, `__LDBL_MAX_EXP__`), with regression coverage in both standard macro expansion and CLI `-U` removal behavior.
  - Iteration 3 slice: tightened sema typedef-storage-class object-declaration diagnostics by making file-scope and block-scope `DeclStmt(..., storage_class="typedef")` failures action-oriented (`...; use a typedef declaration instead`) instead of generic storage-class rejections; updated focused sema regressions and frontend coverage docs.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_file_scope_object_declaration_rejects_typedef_storage_class tests.test_sema.SemaTests.test_block_scope_object_declaration_rejects_typedef_storage_class -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: added end-to-end `-nostdinc` support (options/CLI/preprocessor) to disable environment-provided include roots (`CPATH`, `C_INCLUDE_PATH`) for deterministic include resolution while preserving explicit include directories (`-I`, `-iquote`, `-isystem`, `-idirafter`); added focused preprocessor + CLI regressions and frontend docs update.
  - Iteration 3 slice: upgraded sema `_Generic` invalid-association diagnostics to report association position, resolved type label, and parser source location (`line`/`column`) when available (`Invalid generic association type at position N ('type') at line ..., column ...: <reason>`), while preserving a stable fallback message for manually constructed ASTs without location metadata.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_void_association_type_error tests.test_sema.SemaTests.test_generic_selection_atomic_association_type_error tests.test_sema.SemaTests.test_generic_selection_incomplete_record_association_type_error tests.test_sema.SemaTests.test_generic_selection_vla_association_type_error tests.test_sema.SemaTests.test_generic_selection_invalid_association_type_error_without_location -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: extended preprocessor include-root handling with GCC-style environment search paths by honoring `CPATH` (after `-I`) and `C_INCLUDE_PATH` (after `-isystem`) for both directive includes and `__has_include` probing; added focused preprocessor + CLI regressions for quoted/angle precedence and end-to-end CLI behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_quoted_uses_cpath_when_include_dirs_miss tests.test_preprocessor.PreprocessorTests.test_include_angle_prefers_include_dirs_over_cpath tests.test_preprocessor.PreprocessorTests.test_include_angle_uses_c_include_path_after_system_dirs tests.test_cli.CliTests.test_main_cpath_environment_include -q` (pass).
  - Iteration 3 slice: implemented GNU `#elifdef` / `#elifndef` conditional-directive support in preprocessor conditional stacks (including `#... after #else` validation parity with `#elif`), while keeping strict `c11` behavior unchanged by reporting `Unknown preprocessor directive` for those GNU-only directives; added focused regressions for GNU success paths, strict-mode rejection, and `#elifdef after #else` diagnostics.
  - Iteration 3 slice: expanded predefined LP64 target-assumption macros with floating-size coverage (`__SIZEOF_FLOAT__=4`, `__SIZEOF_DOUBLE__=8`, `__SIZEOF_LONG_DOUBLE__=16`) so preprocessor size assumptions now cover scalar floating families in the same way integer and typedef-backed families are already modeled; added regression coverage for both standard expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: fixed `#if`/`#elif` macro-rescanning order for include-probing operators by expanding macros before `__has_include(...)` / `__has_include_next(...)` rewriting, so operator spellings introduced via wrapper macros (for example `#define HAS(x) __has_include(x)`) now evaluate correctly; added focused GNU/C11 preprocessor regressions for macro-expanded `__has_include` and `__has_include_next` operator paths.
  - Iteration 3 slice: tightened parameter-list diagnostics to point at the actual unexpected token after separators (`)` after trailing commas and the first non-`)` token after `...`) and made trailing-comma wording explicit (`Expected parameter declaration after ','`) across both direct function declarations and function-suffix declarators; synced clang-suite parser fixture expectations for all trailing-comma and non-terminal-ellipsis variants.
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser -q` (pass).
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_expected_frontend_stage -q` (expected known unrelated failures remain: `sema-alignas-c11`, `_Complex`-driven `sema-warn-absolute-value-long-long`, C23 `typeof_unqual` case, and static-assert expression-start fixtures).
  - Iteration 3 slice: normalized parser declaration/type-name unsupported-token diagnostics by adding a declaration-context token formatter (`Declaration type cannot start with <token kind>`) and an explicit end-of-input declaration diagnostic (`Declaration type is missing before end of input`), aligning declaration wording with existing type-name diagnostics.
  - Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_unsupported_non_keyword_type_uses_declaration_token_diagnostic tests.test_parser.ParserTests.test_unsupported_declaration_type_reports_end_of_input_message tests.test_parser.ParserTests.test_unsupported_non_keyword_type_uses_type_name_token_diagnostic tests.test_parser.ParserTests.test_unsupported_type_name_reports_end_of_input_message -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_parser -q` (pass).
  - Iteration 3 slice: added preprocessing mode-specific predefined macros so strict `c11` now exposes `__STRICT_ANSI__`, while `gnu11` exposes GNU compatibility version macros (`__GNUC__`, `__GNUC_MINOR__`, `__GNUC_PATCHLEVEL__`, `__VERSION__`); added focused regressions for both presence and absence across language modes.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_strict_mode_defines_strict_ansi_macro tests.test_preprocessor.PreprocessorTests.test_gnu_mode_defines_gnu_version_macros tests.test_preprocessor.PreprocessorTests.test_gnu_mode_does_not_define_strict_ansi_macro tests.test_preprocessor.PreprocessorTests.test_strict_mode_does_not_define_gnu_version_macros -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: upgraded sema `_Generic` no-match diagnostics to include association position and parser-provided source location context for each available type (`'int' at position 1 (line ..., column ...)`), while preserving location-less fallback wording for manually constructed AST tests.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_without_match_error tests.test_sema.SemaTests.test_generic_selection_without_match_reports_all_association_types tests.test_sema.SemaTests.test_generic_selection_without_match_reports_position_without_locations -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: improved `_Generic` duplicate-`default` diagnostics end-to-end by recording parser source locations for each generic association and surfacing the earlier `default` line/column in sema failures (for example `previous default was at position 1 at line 4, column 12`); added parser/sema regressions for association-location capture and the enriched semantic error text.
  - Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_records_association_source_locations tests.test_sema.SemaTests.test_generic_selection_duplicate_default_association_error tests.test_sema.SemaTests.test_generic_selection_duplicate_default_association_error_with_location -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_parser tests.test_sema -q` (pass).
  - Iteration 3 slice: made `__has_include(...)`/`__has_include_next(...)` conditional-expression failures reason-specific by replacing the generic `Invalid __has_include expression` fallback with actionable diagnostics (`expected '(' after operator`, `missing closing ')'`, `missing header operand`, `header operand must be quoted or angled`), and added focused preprocessor regressions for empty/malformed operator operands.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_macro_expands_to_invalid_header tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_invalid_form tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_missing_operand tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_missing_closing_paren -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: fixed GNU include-next root traversal so `#include_next` and `__has_include_next(...)` now skip later duplicate aliases of the current resolved include root (for example symlinked `-I` repeats), preventing accidental self-reentry and false-positive include-next probes; added focused preprocessor regressions for both directive and conditional-operator paths.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_next_skips_later_duplicate_of_current_root tests.test_preprocessor.PreprocessorTests.test_has_include_next_skips_later_duplicate_of_current_root tests.test_preprocessor.PreprocessorTests.test_include_next_in_gnu_mode_uses_following_include_directory tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_next_skips_current_directory -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: made parser void-object rejection diagnostics context-specific by replacing generic parse-time messages with `Invalid object type for object declaration: void` and `Invalid object type for record member declaration: void`, plus focused parser regressions for both declaration contexts.
  - Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_record_member_rejects_void_object_type_with_contextual_diagnostic tests.test_parser.ParserTests.test_file_scope_declaration_rejects_void_object_type_with_contextual_diagnostic -q` (pass).
  - Iteration 3 slice: implemented CLI macro-include support (`-imacros <header>`) end-to-end (options/CLI/preprocessor) so macro-include files are processed before forced includes, export macro definitions into subsequent preprocessing, and discard non-directive source output; added dedicated diagnostics (`Macro include not found: ...`) and include-trace labeling (`#imacros`).
  - Checks: `.venv/bin/python -m unittest tests.test_options tests.test_cli tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 pointer-family assumptions with `intptr_t`/`uintptr_t` macro coverage (`__INTPTR_TYPE__=long`, `__UINTPTR_TYPE__=unsigned long`, `__INTPTR_WIDTH__=64`, `__UINTPTR_WIDTH__=64`, `__INTPTR_MAX__=9223372036854775807L`, `__INTPTR_MIN__=-9223372036854775808L`, `__UINTPTR_MAX__=18446744073709551615UL`) and extended regression coverage in both standard-macro expansion and CLI `-U` override paths.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 target-assumption macro coverage with `sig_atomic_t` assumptions (`__SIG_ATOMIC_TYPE__=int`, `__SIG_ATOMIC_WIDTH__=32`, `__SIG_ATOMIC_MAX__=2147483647`, `__SIG_ATOMIC_MIN__=-2147483648`) and extended regression coverage in both standard-macro expansion and CLI `-U` override paths.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: implemented CLI forced-include support (`-include <header>`) end-to-end (options/CLI/preprocessor), so configured headers are preprocessed before the main translation unit using the quoted-include search chain (`source dir`, `-iquote`, `-I`, `-isystem`, `-idirafter`), with dedicated missing-header diagnostics (`Forced include not found: ...`); added focused preprocessor and CLI regressions.
  - Checks: `.venv/bin/python -m unittest tests.test_options tests.test_cli.CliTests.test_main_forced_include_option tests.test_preprocessor.PreprocessorTests.test_forced_include_applies_before_main_source tests.test_preprocessor.PreprocessorTests.test_forced_include_not_found -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_cli tests.test_preprocessor tests.test_options -q` (pass).
  - Iteration 3 slice: made sema function storage-class diagnostics declaration-context-specific by distinguishing file-scope and block-scope function declaration failures (`Invalid storage class for file-scope function declaration: ...` vs `Invalid storage class for block-scope function declaration: ...`), and updated focused sema regressions for both contexts.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_function_invalid_storage_class_error tests.test_sema.SemaTests.test_block_scope_function_rejects_static_storage_class tests.test_sema.SemaTests.test_block_scope_function_rejects_register_storage_class -q` (pass).
  - Iteration 3 slice: added LP64 predefined macro compatibility aliases `__LP64` and `_LP64` alongside `__LP64__`, so codebases that key off either GCC/Clang alias family now preprocess consistently under xcc; extended predefined-macro expansion and `-U` regression coverage for both aliases.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: implemented `-idirafter` include path support end-to-end (CLI/options/preprocessor), extending angle-include search order to `-I` then `-isystem` then `-idirafter` while preserving quoted include precedence and include-next traversal over the same merged search chain; added focused preprocessor and CLI regressions for `-idirafter` fallback and precedence.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_angle_prefers_system_dirs_over_idirafter tests.test_preprocessor.PreprocessorTests.test_include_angle_uses_idirafter_when_earlier_roots_miss tests.test_cli.CliTests.test_main_idirafter_option tests.test_options -q` (pass).
  - Iteration 3 slice: implemented `-iquote` include path support end-to-end (CLI/options/preprocessor) so quoted includes now search source directory, then `-iquote`, then `-I`/`-isystem`, while angle includes continue to skip source/`-iquote`; added focused preprocessor and CLI regressions for quoted/angle precedence behavior.
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_quoted_prefers_quote_include_dirs_over_include_dirs tests.test_preprocessor.PreprocessorTests.test_include_angle_ignores_quote_include_dirs tests.test_cli.CliTests.test_main_iquote_option tests.test_options -q` (pass).
  - Iteration 3 slice: made sema typedef atomic-type diagnostics declaration-context-specific by replacing generic `Invalid atomic type` errors with scope-aware messages (`Invalid atomic type for file-scope typedef declaration` / `Invalid atomic type for block-scope typedef declaration`), and updated focused sema regressions for both typedef contexts.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_atomic_invalid_typedef_type_error tests.test_sema.SemaTests.test_atomic_invalid_block_typedef_type_error -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: fixed union initializer-list validation so union objects now reject multiple designated initializers (for example `{.x = 1, .y = 2}`) and mixed positional+designated second initializers (`{1, .y = 2}`), matching the single-active-member initialization constraint; added focused sema regressions for both failure shapes.
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_sema.SemaTests.test_union_initializer_rejects_multiple_positional_items_error tests.test_sema.SemaTests.test_union_designated_initializer_ok tests.test_sema.SemaTests.test_union_initializer_rejects_multiple_designated_items_error tests.test_sema.SemaTests.test_union_initializer_rejects_designated_after_positional_item_error -q` (pass).
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: tightened record-member bit-field constraint enforcement by rejecting named zero-width bit-fields (`struct S { unsigned x:0; };`) while preserving unnamed zero-width separator support (`unsigned :0;`); added focused sema regression coverage for the new named-width diagnostic.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_named_bit_field_zero_width_error tests.test_sema.SemaTests.test_unnamed_bit_field_zero_width_ok tests.test_sema.SemaTests.test_unnamed_bit_field_nonzero_width_error tests.test_sema.SemaTests.test_bit_field_width_exceeds_type_error -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 signed integer range assumptions with missing narrow-family minimum macros (`__SCHAR_MIN__`, `__SHRT_MIN__`, `__INT_MIN__`) so preprocessing now exposes both max/min bounds consistently across signed integer families; added regression coverage for standard expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: removed parser's silent acceptance of trailing `_Complex` type specifiers (`float _Complex`, `double _Complex`, `long double _Complex`, and integer-base forms) so complex types are now rejected consistently with the existing unsupported `_Complex` baseline, and added parser regressions for both declaration and `sizeof(type-name)` diagnostic contexts.
  - Checks: `uv run python -m unittest tests.test_parser.ParserTests.test_complex_specifier_is_rejected_after_floating_base_type tests.test_parser.ParserTests.test_complex_specifier_requires_floating_base_type tests.test_parser.ParserTests.test_complex_specifier_is_rejected_after_integer_base_type tests.test_parser.ParserTests.test_unsupported_type_uses_declaration_context_diagnostic tests.test_parser.ParserTests.test_unsupported_type_uses_type_name_context_diagnostic tests.test_parser.ParserTests.test_unsupported_trailing_complex_type_uses_type_name_context_diagnostic -q` (pass).
  - Checks: `uv run python -m unittest tests.test_parser -q` (pass).
  - Iteration 3 slice: made sema `_Alignas` declaration diagnostics reason-specific by reporting why explicit alignment is invalid (non-positive, non-power-of-two, or weaker than natural alignment) across file-scope objects, block-scope objects, and record members; added focused regressions for weaker/natural and non-power-of-two alignment failures.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_alignas_rejects_weaker_alignment_than_type tests.test_sema.SemaTests.test_alignas_file_scope_weaker_alignment_error tests.test_sema.SemaTests.test_alignas_rejects_member_weaker_than_natural_alignment tests.test_sema.SemaTests.test_alignas_rejects_block_scope_non_power_of_two_alignment -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: upgraded parser `_Generic` duplicate canonical-equivalent type diagnostics to include previous/current association spellings (for example `short` vs `short int` and qualifier-order variants), and added focused parser regressions for canonical short aliases plus qualifier-order canonicalization (`const volatile int` vs `volatile const int`).
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_identical_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_integer_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_long_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_unsigned_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_short_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_qualifier_order_type_association -q` (pass).
  - Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser -q` (pass).
  - Iteration 3 slice: expanded LP64 predefined target-assumption sizeof coverage for typedef-backed families (`__SIZEOF_SIZE_T__`, `__SIZEOF_PTRDIFF_T__`, `__SIZEOF_INTMAX_T__`, `__SIZEOF_UINTMAX_T__`, `__SIZEOF_WCHAR_T__`, `__SIZEOF_WINT_T__`), with regression coverage in both standard macro expansion and CLI `-U` removal paths.
  - Iteration 3 slice: expanded predefined signed integer range assumptions with explicit minimum macros (`__LONG_MIN__`, `__LONG_LONG_MIN__`, `__INTMAX_MIN__`, `__PTRDIFF_MIN__`) so LP64 target assumptions now publish both max and min bounds for core signed families; added regression coverage for macro expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: tightened GNU indirect-goto control-flow validation so `goto *expr;` now requires a `void*` target expression (still rejecting non-pointers), closing a compatibility gap where non-void pointers were previously accepted; added focused sema regressions for `int*` and function-pointer operands.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_indirect_goto_pointer_operand_ok tests.test_sema.SemaTests.test_indirect_goto_requires_pointer_operand tests.test_sema.SemaTests.test_indirect_goto_requires_void_pointer_operand tests.test_sema.SemaTests.test_indirect_goto_rejects_function_pointer_operand -q` (pass).
  - Iteration 3 slice: expanded predefined wide-character target-assumption macros with explicit bounds (`__WCHAR_MAX__`, `__WCHAR_MIN__`, `__WINT_MAX__`, `__WINT_MIN__`) so preprocessing now advertises both width and value-range assumptions for `wchar_t`/`wint_t`; added regression coverage for expansion and CLI `-U` passthrough behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: added GNU-compatible predefined static macro `__TIMESTAMP__` (translation-start timestamp literal) alongside existing `__DATE__`/`__TIME__`, with regression coverage for expansion/macro-table visibility and CLI `-U` passthrough behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_date_time_and_timestamp_macros_use_translation_start_time tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_timestamp_macro tests.test_preprocessor.PreprocessorTests.test_predefined_date_and_time_do_not_force_retokenization -q` (pass).
  - Iteration 3 slice: added predefined dynamic macro `__FILE_NAME__` (GNU-compatible basename of the current logical `__FILE__`) so nested includes and `#line`-remapped filenames now expand to just the leaf name, with regression coverage for expansion and CLI `-U` passthrough behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_predefined_file_and_line_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_file_name_macro tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: added predefined C integer-constructor macros `__INTMAX_C(value)` and `__UINTMAX_C(value)` with token-pasting suffix expansion (`##LL`/`##ULL`) and wired CLI `-D` parsing to accept function-like definitions (`NAME(args)=...`) in addition to object-like defines.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_cli_define_function_like_macro tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_intmax_constructor_macros -q` (pass).
  - Iteration 3 slice: added GNU-compatible predefined dynamic macro `__BASE_FILE__`, wired it to always expand to the primary translation-unit filename (including inside nested includes and after `#line` remapping), and added focused regression coverage for expansion plus CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_predefined_file_and_line_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_base_file_macro -q` (pass).
  - Iteration 3 slice: expanded predefined width assumptions with `__INTMAX_WIDTH__=64`, `__UINTMAX_WIDTH__=64`, and `__WINT_WIDTH__=32`, and added regression coverage for expansion plus CLI `-U` removal behavior to keep predefined-macro baseline checks consistent across integer and wide-character families.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: made include diagnostics/tracing directive-aware for GNU `#include_next` by preserving `#include` wording for normal includes while reporting `Include not found via #include_next: ...` on `#include_next` misses and recording `#include_next` entries in include traces; added focused regression coverage for both the new diagnostic wording and trace labeling.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_next_missing_header_reports_include_next_context tests.test_preprocessor.PreprocessorTests.test_include_next_trace_uses_include_next_directive_name tests.test_preprocessor.PreprocessorTests.test_include_next_in_gnu_mode_uses_following_include_directory tests.test_preprocessor.PreprocessorTests.test_include_trace_and_macro_table -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 integer-width/range assumptions with size/pointer widths and signed/unsigned max-value macros (`__SIZE_WIDTH__`, `__PTRDIFF_WIDTH__`, `__SCHAR_MAX__`, `__SHRT_MAX__`, `__INT_MAX__`, `__LONG_MAX__`, `__UCHAR_MAX__`, `__USHRT_MAX__`, `__UINT_MAX__`, `__ULONG_MAX__`, `__SIZE_MAX__`, `__PTRDIFF_MAX__`), with regression coverage for expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: added predefined dynamic macro `__COUNTER__` with monotonic expansion semantics (including expansions that occur through user-defined macros) and CLI `-U` override behavior, plus focused regression coverage for increment ordering and undef passthrough.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_counter_macro_increments_per_expansion tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_counter_macro -q` (pass).
  - Iteration 3 slice: upgraded circular-include diagnostics to report the concrete include cycle chain (`a.h -> b.h -> a.h`) instead of a generic cycle message, making recursive-include root-cause triage immediate from a single failure.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_circular_include tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined C11 wide-character conformance baseline with `__STDC_ISO_10646__=201706L`, so preprocessing now explicitly advertises Unicode scalar value mapping assumptions for `wchar_t` alongside existing wide-character type/width macros; added regression coverage for both expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 little-endian target-assumption macros with endian aliases (`__LITTLE_ENDIAN__`, `__BIG_ENDIAN__`) and floating word order (`__FLOAT_WORD_ORDER__`), with regression coverage for macro expansion plus CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 target-type assumptions with wide-character baseline macros (`__WCHAR_TYPE__=int`, `__WINT_TYPE__=unsigned int`, `__WCHAR_WIDTH__=32`), and added regression coverage for both macro expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: added GNU `__has_include_next(...)` support in `#if`/`#elif` condition evaluation so include-probing can continue search after the current include directory (mirroring `#include_next` search semantics), while C11 mode keeps rejecting it as an invalid conditional expression; added focused regression coverage for GNU success/failure paths and C11 rejection.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_next_in_gnu11 tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_next_skips_current_directory tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_next_errors_in_c11 -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined C11 macro behavior with `__STDC_MB_MIGHT_NEQ_WC__=1` to make multibyte-vs-wide-character encoding assumptions explicit in preprocessing output, including regression coverage for macro expansion and CLI `-U` removal behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: aligned preprocessor include-trace source reporting with logical source mapping (`#line`) by emitting the mapped filename/line for `#include` trace entries instead of the physical include-stack path, with focused regression coverage for mapped include traces.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_trace_and_macro_table tests.test_preprocessor.PreprocessorTests.test_include_trace_uses_line_mapped_source_location -q` (pass).
  - Iteration 3 slice: deduplicated preprocessor include search roots after path resolution so include probing and include-not-found diagnostics now report each effective root once even when `-I` entries repeat or alias the same directory (for example via symlinks), with focused regression coverage for both diagnostics and successful include resolution.
  - Iteration 3 slice: improved include-not-found diagnostics by appending the ordered searched include roots (`...; searched: <root1>, <root2>` or `<none>`), preserving quoted/angle delimiter reporting while making missing-header failures actionable for include-path debugging.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_include_not_found tests.test_preprocessor.PreprocessorTests.test_include_not_found_for_angle_include_reports_delimiters tests.test_preprocessor.PreprocessorTests.test_include_not_found_reports_search_roots -q` (pass).
  - Iteration 3 slice: added predefined dynamic macro `__INCLUDE_LEVEL__` with nested-include depth tracking (`0` in the main file, incremented for each include nesting level), including CLI `-U` behavior and nested-include regression coverage.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_include_level_macro_tracks_nested_includes tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_include_level_macro tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: expanded predefined C11 macro coverage with `__STDC_IEC_559__=1` so preprocessing now explicitly advertises IEC 60559 floating-point support assumptions alongside the existing `__STDC__`/`__STDC_VERSION__` baseline.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Iteration 3 slice: improved `_Generic` duplicate-association diagnostics with association-order context by reporting both the current and previous association positions for duplicate default associations and duplicate compatible type associations, while keeping selection behavior unchanged.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_duplicate_compatible_type_error tests.test_sema.SemaTests.test_generic_selection_duplicate_default_association_error -q` (pass).
  - Iteration 3 slice: expanded the predefined C11 macro baseline with implementation-availability macros (`__STDC_NO_ATOMICS__`, `__STDC_NO_COMPLEX__`, `__STDC_NO_THREADS__`, `__STDC_NO_VLA__`) so preprocessing now advertises unsupported optional C11 feature families explicitly instead of leaving them implicit.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: enforced block-scope function-declaration storage/specifier constraints by rejecting non-`extern` storage classes (`static`, `register`, etc.) and `_Thread_local` on function declarations parsed as declaration statements, aligning these paths with existing function-level diagnostics (`Invalid storage class for function: ...` / `Invalid declaration specifier for function declaration: '_Thread_local'`).
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_block_scope_function_rejects_static_storage_class tests.test_sema.SemaTests.test_block_scope_function_rejects_register_storage_class tests.test_sema.SemaTests.test_block_scope_function_rejects_thread_local_specifier -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: tightened file-scope declaration-analysis diagnostics by making `auto`/`register` storage-class rejections object-declaration-specific (`Invalid storage class for file-scope object declaration: ...`) and making tag-only `_Alignas` failures explicitly object-contextual (`Invalid alignment specifier for file-scope object declaration without identifier`), with focused sema regression coverage for both `register` and `auto` file-scope declarations.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_file_scope_invalid_storage_class_error tests.test_sema.SemaTests.test_file_scope_auto_storage_class_error tests.test_sema.SemaTests.test_alignas_tag_only_declaration_error -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: expanded predefined LP64 target-assumption macros with endian and fundamental-size coverage (`__CHAR_BIT__`, `__SIZEOF_SHORT__`, `__SIZEOF_INT__`, `__SIZEOF_LONG_LONG__`, `__ORDER_LITTLE_ENDIAN__`, `__ORDER_BIG_ENDIAN__`, `__BYTE_ORDER__`) and added regression coverage for expansion plus CLI `-U` behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: expanded predefined preprocessor target-assumption baseline for LP64 hosts by adding `__LP64__`, `__SIZEOF_POINTER__`, `__SIZEOF_LONG__`, `__SIZE_TYPE__`, and `__PTRDIFF_TYPE__`, with regression coverage for expansion plus CLI `-U` override behavior.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_standard_macros tests.test_preprocessor.PreprocessorTests.test_cli_undef_removes_predefined_macro -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: made `#line` parsing macro-aware by expanding directive operands before validation, accepting decimal line macros and optional filename-string macros while preserving invalid-directive diagnostics for non-decimal expansions.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_line_directive_expands_macro_operands tests.test_preprocessor.PreprocessorTests.test_line_directive_rejects_non_decimal_macro_expansion -q` (pass).
  - Iteration 3 slice: added GNU `#include_next` support in the preprocessor so include search continues after the current include directory (including quoted-include source-dir skipping), while C11 mode keeps rejecting `#include_next` as an unknown directive.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: refined parser `_Alignas(...)` operand diagnostics by replacing the generic `Invalid alignment specifier` fallback with explicit operand-shape errors for non-object type operands (`_Alignas type operand must denote an object type`), non-ICE expressions, non-positive values, and non-power-of-two values; added focused parser regression coverage, including a dedicated non-ICE `_Alignas(n)` case.
  - Iteration 3 slice: made function `_Thread_local` sema rejections declaration-context-specific by replacing the generic `Invalid declaration specifier` fallback with `Invalid declaration specifier for function declaration: '_Thread_local'` for both prototypes and definitions.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_function_thread_local_error tests.test_sema.SemaTests.test_function_definition_thread_local_error -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: upgraded sema declaration-analysis diagnostics for alignment/identifier failures to be context-specific (file-scope object, block-scope object, file-scope without identifier, block-scope without identifier, and record member declaration) instead of generic `Invalid alignment specifier` / `Expected identifier` fallbacks.
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Next target: audit remaining sema declaration-analysis diagnostics for other context-ambiguous wording and apply the same token-aware/context-aware pattern where behavior is unchanged.
  - Iteration 3 slice: replaced generic record-member declaration rejections (`Invalid member type`) with reason-specific object-type diagnostics for void/atomic/function/incomplete member declarations (`Invalid object type for record member declaration: <reason>`), and updated focused sema regressions to lock in each message.
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_atomic_invalid_member_type_error tests.test_sema.SemaTests.test_invalid_record_member_type_void_error tests.test_sema.SemaTests.test_invalid_record_member_function_type_error tests.test_sema.SemaTests.test_invalid_record_member_incomplete_type_error -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_sema -q` (pass).
  - Iteration 3 slice: extended `__has_include(...)` condition handling to accept macro-expanded header operands (`#define HDR "x.h"` / `#define HDR <x.h>`), while preserving `Invalid __has_include expression` diagnostics for invalid expansions.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_macro_expands_to_quoted_header tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_macro_expands_to_angle_header tests.test_preprocessor.PreprocessorTests.test_if_expression_with_has_include_macro_expands_to_invalid_header -q` (pass).
  - Iteration 3 slice: implemented `#pragma once` tracking in the preprocessor so once-marked headers are skipped on subsequent direct and nested includes, with focused regression coverage for repeated includes and wrapper-include scenarios.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_pragma_once_skips_second_include tests.test_preprocessor.PreprocessorTests.test_pragma_once_applies_across_nested_includes tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: implemented macro-expanded `#include` target parsing so object-like macros can provide either `"..."` or `<...>` header operands (`#define HDR "inc.h"` / `#define HDR <inc.h>`), with explicit invalid-expansion diagnostics when macro results are not header names.
  - Iteration 3 slice: expanded preprocessor include search + `__has_include` regression coverage for path precedence and nested-include base-dir behavior by adding focused tests for include-vs-system precedence (`#include <...>` and `#include "..."` fallback ordering) plus a nested-header `__has_include("local.h")` case that resolves relative to the including header directory.
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Checks: `.venv/bin/python -m unittest tests.test_preprocessor -q` (pass).
  - Iteration 3 slice: made sema object-declaration storage-class diagnostics context-specific for synthetic `DeclStmt(..., storage_class="typedef")` paths by splitting file-scope and block-scope errors (`Invalid storage class for file-scope object declaration: 'typedef'` vs `Invalid storage class for block-scope object declaration: 'typedef'`).
  - Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_file_scope_object_declaration_rejects_typedef_storage_class tests.test_sema.SemaTests.test_block_scope_object_declaration_rejects_typedef_storage_class tests.test_sema -q` (pass).
  - Iteration 3 slice: fixed predefined-macro fast-path gating by treating `__DATE__`/`__TIME__` as predefined names, so non-macro lines no longer get retokenized into spaced output when only builtin macros are active; updated preprocessor regressions for include/`__has_include` output-shape expectations and added a focused no-retokenization test.
  - preprocessor predefined standard macro baseline now includes `__STDC_UTF_16__=1` and `__STDC_UTF_32__=1`, with regression coverage for expansion and CLI `-U` removal behavior;
  - preprocessor `#if`/`#elif` now supports `__has_include("...")` and `__has_include(<...>)` with include-path-aware evaluation plus invalid-form diagnostics;
  - predefined macro baseline now includes `__STDC_HOSTED__=1` alongside `__STDC__` / `__STDC_VERSION__`, with regression coverage for expansion behavior;
  - compound assignment accepts arithmetic operands for `*=`, `/=`, `+=`, `-=` and keeps integer-only checks for `%=` / bit/shift assigns;
  - pointer subtraction/relational checks now accept qualified-compatible object pointers and reject `void*` subtraction;
  - assignment/argument/equality/conditional paths now reject nested pointer qualifier promotions such as `int **` to `const int **`;
  - Iteration 3 slice: replaced generic sema fallback `Unsupported expression` for unknown binary operators with operator-specific diagnostics (`Unsupported binary operator: <op>`), while preserving supported `BinaryExpr` analysis paths.
  - Iteration 3 slice: replaced generic sema fallback `Unsupported expression` for unknown unary operators with operator-specific diagnostics (`Unsupported unary operator: <op>`), while preserving supported `UnaryExpr` analysis paths.
  - Iteration 3 slice: removed the implicit assignment-operator fallback in sema by validating compound operators explicitly and emitting `Unsupported assignment operator: <op>` for unknown `AssignExpr.op` values.
  - Iteration 3 slice: removed the implicit update-operator fallback in sema by validating `UpdateExpr.op` and emitting `Unsupported update operator: <op>` for unknown update operators.
  - Iteration 3 slice: replaced the generic sema fallback `Unsupported expression` with node-specific diagnostics (`Unsupported expression node: <ExprClass>`), reducing opaque fallback behavior for unsupported expression AST nodes.
  - Iteration 3 slice: removed the shared shift-family fallback diagnostic (`Binary operator requires integer operands`) by adding operand-specific checks for `<<`/`>>` (`Shift left operand must be integer` / `Shift right operand must be integer`).
  - Iteration 3 slice: replaced the generic statement fallback (`Unsupported statement`) with a node-specific diagnostic (`Unsupported statement node: <StmtClass>`), reducing opaque sema failures for unsupported statement AST nodes.
  - Iteration 3 slice: replaced the generic file-scope declaration fallback (`Unsupported file-scope declaration`) with a node-specific diagnostic (`Unsupported file-scope declaration node: <DeclClass>`), improving unsupported top-level declaration diagnostics.
  - Iteration 3 slice: tightened condition validation by enforcing scalar conditions for `if`/`for`/`while`/`do-while`/`?:` and integer conditions for `switch`, with dedicated diagnostics for non-scalar and non-integer cases.
  - Iteration 3 slice: replaced remaining shared multiplicative/modulo/bitwise operand diagnostics with operator- and side-specific checks (`Multiplication/Division/Modulo/Bitwise <left|right> operand ...`) to reduce ambiguous sema failures.
  - Iteration 3 slice: replaced shared equality/logical scalar-operand diagnostics with side-specific messages (`Equality/Logical <left|right> operand must be scalar`) for clearer sema failures.
  - Iteration 3 slice: tightened unary operand constraints and diagnostics by splitting `+`/`-`/`~` checks (`Unary plus/minus operand must be arithmetic`, `Bitwise not operand must be integer`) and allowing floating unary `+`/`-` results.
  - Iteration 3 slice: replaced shared additive diagnostics with operator-specific messages for `+` and `-`, clarifying pointer/integer and pointer-pointer rejection paths.
  - Iteration 3 slice: improved call diagnostics by including expected/got argument counts and 1-based argument index in type mismatch errors.
  - Iteration 3 slice: replaced update-expression generic mismatch diagnostics with a dedicated operand constraint message (`Update operand must be integer or pointer`).
  - Iteration 3 slice: replaced compound-assignment generic mismatch diagnostics with operator-family-specific messages (additive, multiplicative, and bitwise/shift/modulo assignment constraints).
  - Iteration 3 slice: replaced plain assignment mismatch diagnostics with an explicit compatibility message (`Assignment value is not compatible with target type`).
  - Iteration 3 slice: replaced return mismatch diagnostics with an explicit compatibility message (`Return value is not compatible with function return type`).
  - Iteration 3 slice: split cast rejection diagnostics into target, operand, and overload-selection failures for clearer cast errors.
  - Iteration 3 slice: equality now treats casted null pointer constants (`(void*)0`) as null-pointer-compatible even in pointer-vs-pointer comparisons (including function pointers), while preserving existing incompatible pointer diagnostics.
  - Iteration 3 slice: tightened pointer arithmetic constraints so additive/compound-additive/update expressions reject `void*` and function-pointer arithmetic (`+`, `-`, `+=`, `-=`, `++`, `--`) while preserving object-pointer arithmetic.
  - Iteration 3 slice: split scalar/array/record initializer-list designator diagnostics into shape-specific messages (scalar single-item/designator rules and array/member designator kind requirements).
  - Iteration 3 slice: made preprocessor `#if` expression fallback diagnostics node/operator-specific in both evaluators (preprocessor and integer-expression paths), and added regression assertions for the exact error text.
  - Iteration 3 slice: split generic preprocessor/integer-expression literal fallback diagnostics into literal-type-specific messages and added comparator-shape regression coverage for both evaluators.
  - Iteration 3 slice: split parser generic `Unsupported type` diagnostics into context-specific messages (`Unsupported declaration type` vs `Unsupported type name`) and added parser/fixture coverage updates.
  - Iteration 3 slice: split integer type-specifier fallback diagnostics into specific parser errors for duplicate signedness and invalid keyword ordering, with regression coverage for declaration/type-name contexts.
  - Iteration 3 slice: made duplicate storage-class declaration-specifier diagnostics keyword-specific (`Duplicate storage class specifier: '<keyword>'`) and updated parser regression coverage.
  - Iteration 3 slice: made duplicate thread-local declaration-specifier diagnostics keyword-specific (`Duplicate thread-local specifier: '_Thread_local'`) and updated parser regression coverage.
  - Iteration 3 slice: tightened parameter-array declaration diagnostics by rejecting duplicate array qualifiers (`Duplicate type qualifier: '<keyword>'`) and duplicate `static` bounds (`Duplicate array bound specifier: 'static'`), with parser regression coverage updates.
  - Iteration 3 slice: split generic parser array-size fallback diagnostics into context-specific messages (`Array size is required in this context` and `Array size must be an integer constant expression`) and tightened parser regression assertions for these paths.
  - Iteration 3 slice: replaced the generic static-parameter array-size helper error (`Expected array size`) with a context-specific diagnostic (`Array parameter with 'static' requires a size`) and added focused parser regression coverage.
  - Iteration 3 slice: split array-size integer-literal parse failures into source-shape-specific parser diagnostics (`unsupported integer suffix`, `non-octal digits`, `hex literal requires at least one digit`, `decimal digits required`) and expanded parser regression assertions for helper/declarator paths.
  - Iteration 3 slice: replaced the generic non-VLA array-size constant-expression fallback with expression-node-specific diagnostics (`Array size expression '<ExprClass>' is not an integer constant expression`) and expanded parser regression coverage for malformed literal-token and suffix-only decimal-shape branches.
  - Iteration 3 slice: refined array-size non-ICE diagnostics for cast and conditional expressions by reporting conditional-condition failures directly and unwrapping cast operands to their underlying non-ICE cause, with focused parser regression assertions.
  - Iteration 3 slice: split array-size fallback diagnostics for `sizeof`/`_Alignof` expression forms into dedicated messages (`Array size sizeof expression ...` / `Array size alignof expression ...`) and added focused helper regression coverage.
  - Iteration 3 slice: split array-size non-ICE assignment fallback into a node-specific diagnostic (`Array size assignment expression is not an integer constant expression`) and added focused helper regression coverage.
  - Iteration 3 slice: refined unsupported type-specifier diagnostics by including the offending token text in declaration/type-name contexts (`Unsupported declaration type: '<token>'` / `Unsupported type name: '<token>'`) and updated parser regression assertions.
  - Iteration 3 slice: split unknown-identifier type diagnostics from unsupported-keyword diagnostics (`Unknown declaration type name: '<ident>'` / `Unknown type name: '<ident>'`), and routed generic-association type parsing through type-name context diagnostics.
  - Iteration 3 slice: split unsupported non-keyword type diagnostics into token-category-aware messages (`Unsupported declaration/type name token (<category>): '<token>'`) and route non-keyword parse-type-spec failures through these diagnostics with focused parser coverage.
  - Iteration 3 slice: replaced type-name punctuator token fallbacks with punctuator-specific messages for declarator-shape parse branches (`(` / `[` / `;`) and kept parse acceptance behavior unchanged.
  - Iteration 3 slice: expanded type-name punctuator diagnostics for missing-type association separators (`)` / `,` / `:`), reducing generic `Unsupported type name punctuator` fallbacks in malformed `_Generic` associations.
  - Iteration 3 slice: expanded type-name punctuator diagnostics for additional malformed `_Generic` association separators (`?` / `]` / `}`) and added focused parser regression coverage for each punctuation shape.
  - Iteration 3 slice: replaced remaining type-name token fallback diagnostics for malformed `_Generic` association starts by adding explicit non-punctuator and end-of-input messages (`Type name cannot start with <token-kind>...` / `Type name is missing before end of input`), plus focused parser regression coverage.
  - Iteration 3 slice: replaced declaration-context punctuator fallback diagnostics with punctuator-specific messages (`Declaration type cannot start with ...` / `Declaration type is missing before ...`) and added focused parser regression tests for `(`, `[`, and `;` malformed declaration starts.
  - Iteration 3 slice: added a dedicated declaration-context right-parenthesis diagnostic (`Declaration type is missing before ')'`) to reduce remaining `Unsupported declaration type punctuator` fallback usage, with focused parser regression coverage.
  - Iteration 3 slice: added a dedicated declaration-context `*` diagnostic (`Declaration type is missing before '*': pointer declarator requires a base type`) to reduce generic punctuator fallback usage for malformed pointer-style declaration starts, with focused parser regression coverage.
  - Iteration 3 slice: added a dedicated declaration-context `...` diagnostic (`Declaration type is missing before '...': expected a type specifier`) and parser regression coverage, reducing another `Unsupported declaration type punctuator` fallback path.
  - Iteration 3 slice: mapped `-` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '-'...` / `Type name cannot start with '-'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `/` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '/'...` / `Type name cannot start with '/'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `%` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '%'...` / `Type name cannot start with '%'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `%:` digraph punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '%:'...` / `Type name cannot start with '%:'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `%:%:` digraph punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '%:%:'...` / `Type name cannot start with '%:%:'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `*` punctuator fallback in type-name contexts to an explicit diagnostic (`Type name cannot start with '*': expected a type specifier`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `.` and `->` punctuator fallbacks in type-name contexts to explicit diagnostics (`Type name cannot start with '.': ...` / `Type name cannot start with '->': ...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `{` punctuator fallback in type-name contexts to an explicit missing-type diagnostic (`Type name is missing before '{'`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `!` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '!'...` / `Type name cannot start with '!'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `~` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '~'...` / `Type name cannot start with '~'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `&` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '&'...` / `Type name cannot start with '&'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `|` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '|'...` / `Type name cannot start with '|'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `^` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '^'...` / `Type name cannot start with '^'...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped `=` punctuator fallbacks in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '='...` / `Type name cannot start with '='...`) and added focused parser regression coverage.
  - Iteration 3 slice: mapped shift punctuator fallbacks (`<<` / `>>`) in declaration/type-name contexts to explicit diagnostics and added focused parser regression coverage.
  - Iteration 3 slice: mapped compound-assignment punctuator fallbacks (`+=`, `-=`, `*=`, `/=`, `%=` , `&=`, `|=`, `^=`, `<<=`, `>>=`) in declaration/type-name contexts to explicit diagnostics, and added focused parser regression coverage for representative `+=` and `<<=` cases.
  - Iteration 3 slice: expanded parser regression coverage for all remaining compound-assignment punctuator diagnostics in declaration and type-name contexts (`-=`, `*=`, `/=`, `%=` , `&=`, `|=`, `^=`, `>>=`), locking down every mapped token path.
  - Iteration 3 slice: mapped remaining declaration/type-name punctuator fallback diagnostics for preprocessor/digraph tokens (`#`, `##`, `<:`, `:>`, `<%`, `%>`) and added focused parser regression coverage to keep those paths out of generic unsupported-punctuator fallbacks.
  - Iteration 3 slice: added a curated clang-manifest regression case for `#` in declaration type-start position (`int f(#);`) with explicit parse-stage message/position expectations, so external fixture coverage now tracks the hash-specific diagnostic path too.
  - Iteration 3 slice: added a sibling curated clang-manifest regression case for `##` in declaration type-start position (`int f(##);`) with explicit parse-stage message/position expectations, completing hash-token declaration-start coverage in the external fixture suite.
  - Iteration 3 slice: added curated clang-manifest regression coverage for a type-name-start `##` diagnostic path via malformed `_Generic` association (`_Generic(x, ##: 1, default: 0)`), with explicit parse-stage message/position expectations.
  - Iteration 3 slice: added the paired curated clang-manifest regression case for type-name-start `#` in malformed `_Generic` association coverage (`_Generic(x, #: 1, default: 0)`), including explicit parse-stage message/position expectations.
  - Iteration 3 slice: added a curated clang-manifest regression case for the type-name-start `<:` digraph diagnostic path in malformed `_Generic` association coverage (`_Generic(x, <:: 1, default: 0)`), with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for the type-name-start `:>` digraph diagnostic path in malformed `_Generic` association coverage (`_Generic(x, :> : 1, default: 0)`), with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for the type-name-start `<%` digraph diagnostic path in malformed `_Generic` association coverage (`_Generic(x, <% : 1, default: 0)`), with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `%:` digraph coverage (`int f(%:);`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `%:%:` digraph coverage (`int f(%:%:);`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `<%` digraph coverage (`int f(<%);`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `:>` digraph coverage (`int f(:>);`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `<:` digraph coverage in function-parameter context (`int f(<:);`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `%>` digraph coverage in a non-parameter declaration context (`%> value;`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `:>` digraph coverage in a non-parameter declaration context (`:> value;`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `<:` digraph coverage in a non-parameter declaration context (`<: value;`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `<%` digraph coverage in a non-parameter declaration context (`<% value;`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `%:%:` digraph coverage in a non-parameter declaration context (`%:%: value;`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `%:` digraph coverage in a non-parameter declaration context (`%: value;`) with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `%:` digraph coverage in struct-member declaration context (`struct S { %: member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
  - Iteration 3 slice: added the paired curated clang-manifest regression case for declaration type-start `%:%:` digraph coverage in struct-member declaration context (`struct S { %:%: member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Remaining risk: full C11 pointer qualification rules still need structural pointer-level qualifier modeling (current `Type` qualifier representation is base-type-centric).
- Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `<:` digraph coverage in struct-member declaration context (`struct S { <: member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added the paired curated clang-manifest regression case for declaration type-start `<%` digraph coverage in struct-member declaration context (`struct S { <% member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `:>` digraph coverage in struct-member declaration context (`struct S { :> member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added curated clang-manifest regression coverage for hash-at-line-start member declarations (`struct S { # member; };`) as a preprocessor-stage failure (`Unknown preprocessor directive: #member`), with explicit stage/message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `##` coverage in struct-member declaration context (`struct S { ## member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `*` in struct-member declaration context (`struct S { * member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added a curated clang-manifest regression case for declaration type-start `...` in struct-member declaration context (`struct S { ... member; };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added a curated clang-manifest regression case for variadic declarator misuse (`int f(...);`) to lock down the parser diagnostic path `Expected parameter before ...` in the external clang fixture suite.
- Iteration 3 slice: added the sibling curated clang-manifest regression case for function-pointer variadic misuse (`int (*fp)(...);`) with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added a curated clang-manifest regression case for block-scope non-pointer variadic declarator misuse (`int main(){int f(...);return 0;}`) with explicit parse-stage message/position expectations and fixture checksum tracking.
- Iteration 3 slice: added a curated clang-manifest regression case for variadic declarator misuse in `for`-init declaration context (`int main(){for (int f(...);;){}}`) with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Iteration 3 slice: added a curated clang-manifest regression case for function-pointer variadic declarator misuse in `for`-init declaration context (`int main(){for (int (*fp)(...);;){}}`) with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Iteration 3 slice: added a curated clang-manifest regression case for function-pointer variadic declarator misuse in struct-member declaration context (`struct S { int (*fp)(...); };`) with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Iteration 3 slice: added a curated clang-manifest regression case for non-pointer variadic declarator misuse in struct-member declaration context (`struct S { int f(...); };`) with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Iteration 3 slice: added a sibling curated clang-manifest regression case for non-pointer variadic declarator misuse in union-member declaration context (`union U { int f(...); };`) with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Next target: add a curated clang-manifest regression case for variadic declarator misuse in typedef declaration context (`typedef int f(...);`) to lock down the same parser diagnostic path in typedef scope.
- Iteration 3 slice: added a curated clang-manifest regression case for function-pointer variadic declarator misuse in union-member declaration context (`union U { int (*fp)(...); };`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Iteration 3 slice: added a curated clang-manifest regression case for function-pointer variadic declarator misuse in typedef declaration context (`typedef int (*fp)(...);`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Next target: add a curated clang-manifest regression case for variadic declarator misuse in typedef declaration context inside block scope (`int main(){ typedef int f(...); return 0; }`) to lock down this parser diagnostic path in nested typedef scope.
- Iteration 3 slice: added a curated clang-manifest regression case for variadic declarator misuse in block-scope typedef declaration context (`int main(){ typedef int f(...); return 0; }`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Next target: add the sibling curated clang-manifest regression case for function-pointer variadic declarator misuse in block-scope typedef context (`int main(){ typedef int (*fp)(...); return 0; }`) to lock down the same parser diagnostic path for nested typedef function pointers.
- Iteration 3 slice: added a curated clang-manifest regression case for function-pointer variadic declarator misuse in block-scope typedef context (`int main(){ typedef int (*fp)(...); return 0; }`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Next target: add a focused parser unit regression (non-clang fixture) for function-pointer variadic misuse in block-scope typedef context so this diagnostic path is covered in both local parser tests and external clang fixtures.
- Iteration 3 slice: added a focused parser unit regression for typedef variadic declarator misuse at file scope (`typedef int f(...);`) and asserted the exact diagnostic (`Expected parameter before ...`) so this path is covered outside the external clang fixture suite.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_variadic_typedef_requires_fixed_parameter_at_file_scope tests.test_parser.ParserTests.test_variadic_typedef_function_pointer_requires_fixed_parameter_in_block_scope` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: add the sibling focused parser unit regression for file-scope function-pointer typedef variadic misuse (`typedef int (*fp)(...);`) to mirror existing clang-fixture coverage in local parser tests.
- Iteration 3 slice: tightened local parser regression for block-scope variadic function-pointer misuse (`int main(){int (*fp)(...);return 0;}`) by asserting the exact diagnostic message (`Expected parameter before ...`) instead of only checking that parsing fails.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_variadic_function_pointer_requires_fixed_parameter tests.test_parser.ParserTests.test_variadic_typedef_function_pointer_requires_fixed_parameter_at_file_scope` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: add a focused parser unit regression for non-typedef file-scope variadic function declarator misuse (`int f(...);`) with exact diagnostic assertion to mirror the existing clang fixture and strengthen local diagnostic stability coverage.
- Iteration 3 slice: added a focused parser unit regression for function-pointer variadic misuse in struct-member declaration context (`struct S { int (*fp)(...); };`) and asserted the exact diagnostic (`Expected parameter before ...`) so this parser path is now covered in local unit tests, not only clang fixtures.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_variadic_function_pointer_requires_fixed_parameter_in_struct_member tests.test_parser -q` (pass).
- Next target: add the sibling focused parser unit regression for non-pointer variadic misuse in struct-member declaration context (`struct S { int f(...); };`) with the same exact diagnostic assertion.
- Iteration 3 slice: added a focused parser unit regression for non-pointer variadic declarator misuse in `for`-init declaration context (`int main(){for (int f(...);;){} }`) and asserted the exact diagnostic (`Expected parameter before ...`), mirroring existing external clang fixture coverage in local parser tests.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_variadic_function_requires_fixed_parameter_in_for_init_declaration tests.test_parser.ParserTests.test_variadic_function_pointer_requires_fixed_parameter_in_for_init_declaration` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: add a focused parser unit regression for non-pointer variadic declarator misuse in block-scope declaration context (`int main(){int f(...);return 0;}`) with exact diagnostic assertion to mirror external clang fixture coverage locally.
- Iteration 3 slice: added a curated clang-manifest regression case for variadic declarator misuse in `for`-init typedef declaration context (`int main(){for (typedef int f(...);;){} }`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Next target: add the sibling curated clang-manifest regression case for function-pointer variadic declarator misuse in `for`-init typedef declaration context (`int main(){for (typedef int (*fp)(...);;){} }`) to lock down the same parser diagnostic path for typedef function pointers in `for`-init declarations.
- Iteration 3 slice: added a curated clang-manifest regression case for function-pointer variadic declarator misuse in `for`-init typedef declaration context (`int main(){for (typedef int (*fp)(...);;){} }`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Next target: add a focused local parser unit regression for function-pointer variadic declarator misuse in `for`-init typedef declaration context so this diagnostic path is covered in both local parser tests and external clang fixtures.
- Iteration 3 slice: added a focused local parser unit regression for non-pointer variadic declarator misuse in block-scope declaration context (`int main(){int f(...);return 0;}`) and asserted the exact diagnostic (`Expected parameter before ...`) so this parser path is now locked down in local tests.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_variadic_function_requires_fixed_parameter_in_block_scope tests.test_parser -q` (pass).
- Next target: add a focused local parser unit regression for non-pointer variadic declarator misuse in union-member context (`union U { int f(...); };`) to keep local parser coverage aligned with existing clang fixture diagnostics.
- Iteration 3 slice: mapped remaining unary punctuator type-start fallbacks for `++` and `--` in declaration/type-name contexts to explicit diagnostics (`Declaration type is missing before '++'/'--'...` and `Type name cannot start with '++'/'--'...`), and added focused local parser regression coverage for all four paths.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_unsupported_declaration_type_punctuator_reports_increment_message tests.test_parser.ParserTests.test_unsupported_declaration_type_punctuator_reports_decrement_message tests.test_parser.ParserTests.test_unsupported_type_name_punctuator_reports_increment_message tests.test_parser.ParserTests.test_unsupported_type_name_punctuator_reports_decrement_message` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Iteration 3 slice: added curated clang-manifest regression cases for declaration/type-name type-start `++` and `--` punctuator diagnostics (`int f(++);`, `int f(--);`, and malformed `_Generic` associations with `++`/`--`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `uvx tox -e clang_suite -- -q` (pass).
- Next target: add a focused local parser unit regression for non-pointer variadic declarator misuse in union-member context (`union U { int f(...); };`) to keep local parser coverage aligned with existing clang fixture diagnostics.
- Iteration 3 slice: mapped type-name punctuator fallback for `...` to an explicit diagnostic (`Type name cannot start with ...: expected a type specifier`), and added both a focused local parser regression and a curated clang-manifest fixture for malformed `_Generic` associations with checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_unsupported_type_name_punctuator_reports_ellipsis_message tests.test_parser -q` (pass); `uvx tox -e clang_suite -- -q` (pass).
- Next target: add the sibling declaration-context coverage for `...` in malformed declaration starts inside `_Static_assert`/type-name-adjacent parser paths to keep punctuator diagnostics consistent across declaration/type-name entry points.
- Iteration 3 slice: replaced the generic expression-start fallback (`Unexpected token`) for ellipsis with a dedicated parser diagnostic (`Expression cannot start with '...': expected an operand`) and added both a focused local parser regression and a curated clang-manifest fixture for block-scope `_Static_assert`-adjacent usage.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_ellipsis_after_static_assert_reports_operand_diagnostic tests.test_parser -q` (pass); `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Note: `uvx tox -e clang_suite -- -q` is currently blocked by an unrelated preprocessor runtime failure in the dirty workspace (`NameError: _format_date_macro` from `src/xcc/preprocessor.py`) before parser fixtures execute.
- Next target: add the sibling expression-entry diagnostics for other punctuation-only operand starts that still funnel through generic `Unexpected token` in `_parse_primary` (for example `]`/`}`) with focused parser regressions.
- Iteration 3 slice: fixed preprocessor translation-time macro support by defining `__DATE__`/`__TIME__` as concrete string macros at translation start, restoring runtime stability and macro-table visibility while keeping `__FILE__`/`__LINE__` as location-dependent dynamic macros.
- Checks: `.venv/bin/python -m unittest tests.test_preprocessor.PreprocessorTests.test_predefined_date_and_time_macros_use_translation_start_time tests.test_preprocessor -q` (pass).
- Next target: resume parser diagnostic hardening by adding focused `_parse_primary` regressions for punctuation-only operand starts (`]`/`}`) that still report generic `Unexpected token`.
- Iteration 3 slice: replaced `_parse_primary` generic `Unexpected token` fallbacks for punctuation-only expression starts `]` and `}` with explicit operand diagnostics (`Expression cannot start with ']': expected an operand` / `Expression cannot start with '}': expected an operand`) and added focused parser regression coverage in block-scope `_Static_assert`-adjacent contexts.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_right_bracket_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_right_brace_reports_operand_diagnostic tests.test_parser -q` (pass).
- Next target: add sibling `_parse_primary` expression-start diagnostics for additional punctuation-only operands that still report generic `Unexpected token` (for example `)`), with focused parser regressions mirroring statement-adjacent entry points.
- Iteration 3 slice: replaced `_parse_primary` generic `Unexpected token` fallbacks for delimiter-led expression starts (`)`, `,`, `:`) and `}` with explicit operand diagnostics, and added focused parser regression coverage for statement-adjacent entry points.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_right_paren_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_comma_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_colon_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_right_brace_reports_operand_diagnostic tests.test_parser -q` (pass).
- Next target: add sibling `_parse_primary` expression-start diagnostics for additional punctuation-only operands still using generic `Unexpected token` (for example `?`), with focused parser regressions for statement-adjacent entry points.
- Iteration 3 slice: replaced `_parse_primary` generic `Unexpected token` fallbacks for expression starts `?`, `;`, and `{` with explicit operand diagnostics (`Expression cannot start with '?'/';'/'{': expected an operand`), and added focused parser regressions that cover each entry path in expression-required contexts.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_question_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_semicolon_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_left_brace_reports_operand_diagnostic tests.test_parser -q` (pass).
- Next target: extend `_parse_primary` punctuation-start operand diagnostics for remaining operator-only punctuators that still fall through to generic `Unexpected token` (for example `%>` digraph or `##`), with both focused local parser regressions and curated clang-manifest fixtures where parser-stage coverage is reachable.
- Iteration 3 slice: replaced `_parse_primary` generic `Unexpected token` fallbacks for hash/digraph punctuation-led expression starts (`##`, `%:`, `%:%:`, `<:`, `:>`, `<%`, `%>`) with explicit operand diagnostics (`Expression cannot start with '<token>': expected an operand`), keeping parser behavior unchanged while hardening message specificity.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_token_paste_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_hash_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_hash_hash_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_right_brace_digraph_reports_operand_diagnostic` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: add focused local parser regressions for the newly-mapped `<:` / `:>` / `<%` digraph expression-start diagnostics to lock down all delimiter-digraph operand-entry paths explicitly.
- Iteration 3 slice: added focused local parser regressions for expression-start diagnostics on `<:`, `:>`, and `<%`, so all delimiter digraph operand-entry paths now assert exact `Expression cannot start with ...` messages in parser unit tests.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_left_bracket_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_right_bracket_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_left_brace_digraph_reports_operand_diagnostic tests.test_parser -q` (pass).
- Next target: add curated clang-manifest fixtures for expression-start digraph operand diagnostics (`<:`, `:>`, `<%`, `%>`) in statement-adjacent contexts so external conformance coverage mirrors local parser-unit coverage.
- Iteration 3 slice: added curated clang-manifest regression fixtures for statement-adjacent expression-start digraph diagnostics after `_Static_assert` (`<:`, `:>`, `<%`, `%>`), including explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_left_bracket_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_right_bracket_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_left_brace_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_right_brace_digraph_reports_operand_diagnostic -q` (pass); `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Note: `uvx tox -e clang_suite -- -q` still fails due pre-existing unrelated clang-suite baseline mismatches in this workspace (e.g. lexer stage/comment handling and many pre-existing manifest line/column expectation drifts), not caused by this slice.
- Next target: add sibling curated clang-manifest fixtures for expression-start hash/digraph operator tokens (`##`, `%:`, `%:%:`) in statement-adjacent contexts so external coverage matches existing local parser diagnostic regressions.
- Iteration 3 slice: added curated clang-manifest regression fixtures for statement-adjacent expression-start hash/digraph operator diagnostics after `_Static_assert` (`##`, `%:`, `%:%:`), including explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_token_paste_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_hash_digraph_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_hash_hash_digraph_reports_operand_diagnostic -q` (pass); `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Next target: add focused local parser regressions for remaining punctuation-led expression-start operand diagnostics that still rely on generic `Unexpected token` in non-`_Static_assert` entry paths (if any), then mirror newly covered paths into curated clang fixtures.
- Iteration 3 slice: tightened parser parameter-list diagnostics by rejecting trailing commas (`Expected parameter after ','`) and non-terminal ellipsis usage (`Expected ')' after ... in parameter list`) in both regular function declarations/definitions and function-suffix declarators (e.g. typedef function pointers).
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_parameter_list_rejects_non_terminal_ellipsis tests.test_parser.ParserTests.test_function_suffix_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_function_suffix_parameter_list_rejects_non_terminal_ellipsis -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Iteration 3 slice: added curated clang-manifest parser fixtures for trailing-comma and non-terminal-ellipsis parameter-list diagnostics in both direct function declarators and typedef function-pointer declarators, with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_parameter_list_rejects_non_terminal_ellipsis tests.test_parser.ParserTests.test_function_suffix_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_function_suffix_parameter_list_rejects_non_terminal_ellipsis -q` (pass); `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Next target: add focused local parser regressions for trailing-comma and non-terminal-ellipsis parameter-list diagnostics in block-scope and struct/union-member declaration contexts so diagnostic stability is locked down beyond file-scope and typedef declarators.
- Iteration 3 slice: added focused local parser regressions for trailing-comma and non-terminal-ellipsis parameter-list diagnostics in block-scope declarations and struct/union-member declaration contexts, asserting exact diagnostics for each context (`Expected parameter after ','` / `Expected ')' after ... in parameter list`).
- Iteration 3 slice: added matching curated clang-manifest fixtures for the same block-scope and struct/union-member parameter-list diagnostic paths, with explicit parse-stage line/column expectations and fixture checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_block_scope_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_block_scope_parameter_list_rejects_non_terminal_ellipsis tests.test_parser.ParserTests.test_struct_member_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_struct_member_parameter_list_rejects_non_terminal_ellipsis tests.test_parser.ParserTests.test_union_member_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_union_member_parameter_list_rejects_non_terminal_ellipsis -q` (pass); `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Iteration 3 slice: added focused local parser regressions for trailing-comma and non-terminal-ellipsis parameter-list diagnostics in non-typedef function-pointer declarators across block scope and struct/union-member declaration contexts, asserting the exact diagnostics (`Expected parameter after ','` / `Expected ')' after ... in parameter list`) for each nested-scope path.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_block_scope_function_pointer_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_block_scope_function_pointer_parameter_list_rejects_non_terminal_ellipsis tests.test_parser.ParserTests.test_struct_member_function_pointer_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_struct_member_function_pointer_parameter_list_rejects_non_terminal_ellipsis tests.test_parser.ParserTests.test_union_member_function_pointer_parameter_list_rejects_trailing_comma tests.test_parser.ParserTests.test_union_member_function_pointer_parameter_list_rejects_non_terminal_ellipsis -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Iteration 3 slice: added sibling curated clang-manifest fixtures for non-typedef function-pointer parameter-list diagnostics across block-scope and struct/union-member declaration contexts (trailing comma and non-terminal ellipsis), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Next target: audit `_parse_primary` and declaration-expression entry paths for any remaining punctuation-led generic `Unexpected token` diagnostics, then add focused local parser regressions plus curated clang fixtures for each uncovered token.
- Iteration 3 slice: added curated clang-manifest regression fixtures for the remaining bracket/brace expression-start operand diagnostics after `_Static_assert` (`]` and `}`), with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_right_bracket_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_right_brace_reports_operand_diagnostic tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Next target: add sibling curated clang-manifest fixtures for the remaining non-digraph delimiter expression-start operand diagnostics in non-`_Static_assert` contexts (`]` / `}`) so external fixture coverage is context-diverse across delimiter families.
- Iteration 3 slice: added curated clang-manifest regression fixtures for statement-adjacent non-digraph delimiter expression-start diagnostics after `_Static_assert` (`)`, `,`, `:`, `?`, `;`, `{`), each with explicit parse-stage message/position expectations and fixture checksum tracking.
- Checks: `.venv/bin/python -m unittest tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Next target: add focused local parser regressions for any remaining non-`_Static_assert` expression-entry paths that still emit generic punctuation-led `Unexpected token` diagnostics, then mirror any uncovered paths into curated clang fixtures.
- Iteration 3 slice: replaced `_parse_primary` keyword-led generic fallback diagnostics with an explicit operand message (`Expression cannot start with keyword '<kw>': expected an operand`) and added focused parser regression coverage for keyword-led expression starts.
- Iteration 3 slice: updated the curated clang manifest expectation for `C/C23/n2927_2.c` to assert the new keyword-led expression diagnostic text, keeping external fixture coverage aligned with local parser behavior.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_keyword_reports_operand_diagnostic tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Next target: audit non-keyword token kinds that can still hit `_parse_primary`'s generic `Unexpected token` fallback (for example end-of-input and malformed literal categories), then decide whether each path should get a dedicated diagnostic with local regression coverage.
- Iteration 3 slice: replaced `_parse_primary` EOF fallback diagnostics with an explicit expression-missing message (`Expression is missing before end of input`) and added focused local parser regressions for both return-expression and initializer-expression entry paths.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_eof_after_return_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_eof_after_initializer_reports_operand_diagnostic tests.test_parser -q` (pass).
- Next target: audit remaining non-punctuator/non-keyword `_parse_primary` fallback paths (if any) and decide whether they need dedicated diagnostics or should remain as generic parser failures.
- Iteration 3 slice: aligned type-name digraph diagnostics with declaration-context token preservation by reporting `%>` explicitly (`Type name is missing before '%>'`) instead of canonicalizing to `}` in `_Generic` type-name parse failures.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_unsupported_type_name_punctuator_reports_right_brace_digraph_message tests.test_clang_suite.ClangSuiteTests.test_clang_manifest_case_schema tests.test_clang_suite.ClangSuiteTests.test_clang_fixtures_match_manifest_checksums -q` (pass).
- Next target: audit other type-name digraph canonicalization paths for mixed token-vs-canonical spelling in diagnostics and normalize them where consistency still drifts.
- Iteration 3 slice: expanded preprocessor include regression coverage for search precedence and mapping behavior by asserting that quoted includes prefer the source directory while angle includes resolve via configured include paths, plus include-expansion line-map provenance across header and main translation-unit lines.
- Iteration 3 slice: normalized include-not-found diagnostics to preserve directive delimiters (`"..."` vs `<...>`), and added explicit regression checks for both missing quoted and missing angle includes.
- Checks: `python3.11 -m unittest tests.test_preprocessor.PreprocessorTests.test_include_quoted_prefers_source_directory_over_include_path tests.test_preprocessor.PreprocessorTests.test_include_angle_skips_source_directory_and_uses_include_path tests.test_preprocessor.PreprocessorTests.test_include_expansion_preserves_line_map_for_header_source tests.test_preprocessor.PreprocessorTests.test_include_not_found tests.test_preprocessor.PreprocessorTests.test_include_not_found_for_angle_include_reports_delimiters -v` (pass).
- Note: full `tests.test_preprocessor` and `tox -e py311` remain red in this workspace due pre-existing baseline/environment issues unrelated to this slice (e.g. spacing-sensitive expected outputs and missing `coverage` executable inside tox py311 env).
- Iteration 3 slice: replaced `_parse_primary` generic non-punctuator fallback handling for preprocessor-only token kinds with explicit operand diagnostics for preprocessing numbers and header names (`Expression cannot start with preprocessing number...` / `Expression cannot start with header name...`), reducing another opaque `Unexpected token` path.
- Iteration 3 slice: added focused local parser regressions that inject `PP_NUMBER` and `HEADER_NAME` tokens at expression entry to lock down these diagnostics even though translation lexing does not normally emit these token kinds.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_pp_number_reports_operand_diagnostic tests.test_parser.ParserTests.test_expression_start_header_name_reports_operand_diagnostic tests.test_parser -q` (pass).
- Next target: decide whether `_parse_primary` should keep a final generic fallback for truly unreachable token-kind combinations or move to a token-kind-aware internal error diagnostic with dedicated parser coverage.
- Iteration 3 slice: replaced `_parse_primary`'s final generic `Unexpected token` fallback with a token-kind-aware diagnostic (`Expression cannot start with unsupported token kind ...`) that includes the unexpected kind name and lexeme hint to make impossible/internal token-path failures actionable.
- Iteration 3 slice: added focused local parser regression coverage that injects a synthetic non-`TokenKind` token kind at expression entry and asserts the exact new fallback diagnostic text.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_expression_start_unsupported_token_kind_reports_specific_diagnostic tests.test_parser -q` (pass).
- Next target: audit other parser generic fallback sites outside `_parse_primary` for similarly opaque diagnostics and apply token-aware message upgrades where fallback paths are still reachable.
- Iteration 3 slice: tightened type-name parse diagnostics by rejecting named declarators in parenthesized type-name contexts (cast and `_Atomic(type-name)`) with an explicit identifier-bearing message (`Type name cannot declare identifier '<name>'`) instead of the opaque `Expected type name` fallback.
- Iteration 3 slice: added focused local parser regressions for both cast and `_Atomic(type-name)` paths to lock down this diagnostic shape.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_type_name_cannot_declare_identifier_in_cast tests.test_parser.ParserTests.test_type_name_cannot_declare_identifier_in_atomic_type_specifier tests.test_parser -q` (pass).
- Next target: audit remaining parser `Expected identifier` / `Expected type name` diagnostics to identify other contexts where including the offending token/identifier would improve actionability without changing parse behavior.

- Iteration 3 slice: upgraded parser missing-declarator diagnostics to include the blocking token text (`Expected identifier before '<token>'`) and EOF-specific wording (`Expected identifier before end of input`) instead of the opaque generic `Expected identifier`, improving actionability across declaration, record-member, and declarator entry paths.
- Iteration 3 slice: added focused local parser regressions for missing declarators in file-scope declarations and comma-led declarator lists, and updated the existing record-member missing-declarator assertion to the new token-aware diagnostic.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_record_member_rejects_missing_declarator tests.test_parser.ParserTests.test_file_scope_declaration_rejects_missing_declarator_with_token tests.test_parser.ParserTests.test_declarator_rejects_missing_identifier_before_comma -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: audit remaining `Expected type name` diagnostics for contexts where token-aware wording can improve parser actionability without altering accepted grammar.
- Iteration 3 slice: replaced `_parse_type_name`'s remaining opaque `Expected type name` fallback with an identifier-aware diagnostic (`Type name cannot declare identifier '<name>'`) when `_Generic`/type-name contexts incorrectly declare names.
- Iteration 3 slice: added focused local parser regression coverage for named declarators in `_Generic` associations to lock down this diagnostic outside cast and `_Atomic(type-name)` contexts.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_type_name_cannot_declare_identifier_in_generic_association tests.test_parser.ParserTests.test_type_name_cannot_declare_identifier_in_cast tests.test_parser.ParserTests.test_type_name_cannot_declare_identifier_in_atomic_type_specifier tests.test_parser -q` (pass).
- Next target: audit remaining generic parser fallback diagnostics outside type-name/declarator paths and continue replacing them with token-aware messages plus focused regressions.
- Iteration 3 slice: upgraded parser `Invalid declaration specifier` diagnostics in parameter, record-member, and typedef contexts to include both the declaration context and offending specifier keyword (`_Thread_local`/`inline`/`_Noreturn`) for more actionable parse failures.
- Iteration 3 slice: added focused parser regression assertions for the updated context-aware invalid-specifier diagnostics in parameter, record-member, and typedef declarations.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_parameter_rejects_thread_local_specifier tests.test_parser.ParserTests.test_record_member_rejects_function_specifier tests.test_parser.ParserTests.test_typedef_rejects_function_specifier -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: apply the same context-aware diagnostic pattern to remaining generic parser `Invalid * specifier` errors (for example storage-class/alignment contexts) where the offending keyword can be surfaced without grammar changes.
- Iteration 3 slice: upgraded parser alignment-context diagnostics to report where `_Alignas` is invalid (`function declaration`, `typedef declaration`, `parameter`, `tag-only declaration`, and `record member declaration`) instead of using the opaque generic `Invalid alignment specifier` in those contexts.
- Iteration 3 slice: updated focused parser regression assertions for all affected `_Alignas` rejection paths to lock down the new context-aware messages while keeping `_Alignas(...)` value-validation diagnostics unchanged.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_alignas_rejects_function_definition tests.test_parser.ParserTests.test_alignas_rejects_function_declaration tests.test_parser.ParserTests.test_alignas_rejects_typedef_declaration tests.test_parser.ParserTests.test_alignas_rejects_parameter_declaration tests.test_parser.ParserTests.test_alignas_rejects_file_scope_tag_only_declaration tests.test_parser.ParserTests.test_alignas_rejects_block_scope_tag_only_declaration tests.test_parser.ParserTests.test_alignas_rejects_member_tag_only_declaration tests.test_parser.ParserTests.test_alignas_rejects_member_function_declaration -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Iteration 3 slice: upgraded parameter storage-class diagnostics to include the offending keyword (`Invalid storage class for parameter: '<keyword>'`) and point at the exact storage-class token, replacing the previous generic message.
- Iteration 3 slice: added focused parser regression coverage for both `static` and `extern` parameter storage-class rejection paths with exact message assertions.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_parameter_rejects_non_register_storage_class tests.test_parser.ParserTests.test_parameter_rejects_extern_storage_class -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: audit remaining parser storage-class diagnostics outside parameter parsing (where applicable) for similar token-aware context upgrades without changing accepted grammar.
- Iteration 3 slice: upgraded sema storage-class diagnostics to include offending storage-class keywords for invalid function declarations, file-scope object declarations, and `_Thread_local` declarations with missing/invalid storage class (`none`) so failures are context-specific instead of generic.
- Iteration 3 slice: updated sema regression assertions for function/file-scope/thread-local storage-class rejection paths to lock down the new token-aware diagnostics.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_function_invalid_storage_class_error tests.test_sema.SemaTests.test_file_scope_invalid_storage_class_error tests.test_sema.SemaTests.test_invalid_thread_local_storage_class_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: apply the same token-aware diagnostic pattern to remaining sema storage-class rejections (for example object-declaration `typedef` paths) where parser-generated AST nodes can still hit generic wording.
- Iteration 3 slice: upgraded remaining sema storage-class diagnostics for object declarations by making file-scope and block-scope `typedef` object-declaration failures keyword-driven (`Invalid storage class for ... object declaration: '<keyword>'`) instead of hardcoded text, and by splitting `_Thread_local` failures into file-scope vs block-scope object-declaration contexts.
- Iteration 3 slice: added focused sema regression coverage for invalid file-scope `_Thread_local`+`auto` declarations and updated block-scope `_Thread_local` message assertions to the new context-specific wording.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_file_scope_object_declaration_rejects_typedef_storage_class tests.test_sema.SemaTests.test_block_scope_object_declaration_rejects_typedef_storage_class tests.test_sema.SemaTests.test_invalid_thread_local_storage_class_error tests.test_sema.SemaTests.test_file_scope_thread_local_rejects_invalid_storage_class -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: audit remaining sema diagnostics that still use context-ambiguous wording (`Expected identifier`, `Invalid alignment specifier`) in declaration-analysis paths and apply the same context-aware pattern where it improves actionability without changing semantics.
- Iteration 3 slice: upgraded sema alignment diagnostics in declaration analysis to include declaration context (`file-scope object declaration`, `block-scope object declaration`, `record member declaration`, and tag-only declaration paths without identifiers) instead of using the generic `Invalid alignment specifier` wording.
- Iteration 3 slice: updated focused sema regression assertions for file-scope/block-scope `_Alignas` object declarations, tag-only declarations, and record-member alignment failures to lock down the new context-aware diagnostics.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_alignas_rejects_weaker_alignment_than_type tests.test_sema.SemaTests.test_alignas_tag_only_declaration_error tests.test_sema.SemaTests.test_alignas_file_scope_weaker_alignment_error tests.test_sema.SemaTests.test_alignas_block_scope_tag_only_declaration_error tests.test_sema.SemaTests.test_alignas_rejects_member_weaker_than_natural_alignment -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: apply the same context-aware diagnostic pattern to remaining sema declaration-analysis fallbacks that still emit `Expected identifier` without scope/context detail.
- Iteration 3 slice: upgraded sema missing-identifier diagnostics for file-scope/block-scope object declarations to include triggering declaration qualifiers (`storage class '<keyword>'` and/or `'_Thread_local'`) instead of a generic context-only `Expected identifier` message.
- Iteration 3 slice: added focused sema regression coverage for missing identifiers in file-scope `_Thread_local` declarations and block-scope `extern` / `_Thread_local` declarations, and updated the existing file-scope `static` assertion to the new qualifier-aware wording.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_file_scope_storage_without_identifier_error tests.test_sema.SemaTests.test_file_scope_thread_local_without_identifier_error tests.test_sema.SemaTests.test_block_scope_storage_without_identifier_error tests.test_sema.SemaTests.test_block_scope_thread_local_without_identifier_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: audit remaining sema declaration-analysis diagnostics for similar qualifier-loss patterns (for example object-type or linkage-related rejections) and surface the triggering keyword/context where it improves actionability without changing semantics.
- Iteration 3 slice: upgraded sema extern-initializer rejection diagnostics to preserve declaration context by splitting file-scope vs block-scope object-declaration errors (`Invalid initializer for <scope> object declaration with storage class 'extern'`) instead of the generic `Extern declaration cannot have initializer` fallback.
- Iteration 3 slice: updated focused sema regression assertions for both block-scope and file-scope extern initializer rejection paths to lock down the new context-aware wording.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_extern_initializer_error tests.test_sema.SemaTests.test_file_scope_extern_initializer_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Iteration 3 slice: upgraded sema object-type rejection diagnostics in declaration analysis to include declaration scope context (`Invalid object type for file-scope object declaration: ...` / `Invalid object type for block-scope object declaration: ...`) for atomic/void/incomplete object-type failures, while keeping compound-literal expression diagnostics unchanged.
- Iteration 3 slice: updated focused sema regression assertions for file-scope and block-scope object-type rejection paths (atomic, void, and incomplete records) to lock down the new context-aware wording.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_atomic_incomplete_record_pointer_error tests.test_sema.SemaTests.test_atomic_function_object_file_scope_error tests.test_sema.SemaTests.test_atomic_function_object_block_scope_error tests.test_sema.SemaTests.test_file_scope_incomplete_object_error tests.test_sema.SemaTests.test_file_scope_void_object_error tests.test_sema.SemaTests.test_incomplete_struct_object_error tests.test_sema.SemaTests.test_incomplete_union_object_error tests.test_sema.SemaTests.test_incomplete_anonymous_record_object_error tests.test_sema.SemaTests.test_invalid_object_type_void -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: audit sema object-type diagnostics in non-declaration contexts (e.g. compound literals) and decide whether context qualifiers should be surfaced there too without regressing concise expression-level errors.
- Iteration 3 slice: upgraded compound-literal invalid object-type diagnostics to include expression context (`Invalid object type for compound literal: ...`) and aligned all invalid object categories (atomic, void, incomplete record) behind a shared object-type label helper.
- Iteration 3 slice: added focused sema regression coverage for invalid compound-literal object types across `void`, incomplete record, and `_Atomic(void)` cases to lock down the new context-aware wording.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_compound_literal_invalid_object_type_errors tests.test_sema.SemaTests.test_compound_literal_invalid_atomic_object_type_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: audit remaining sema non-declaration diagnostics for context loss (for example expression-level object-type and operand-constraint failures) and upgrade only the paths where added context improves actionability without making core messages noisy.
- Iteration 3 slice: upgraded `sizeof`/`_Alignof` expression diagnostics in sema from generic `Invalid ... operand` fallbacks to reason-specific messages (`void type`, `atomic type`, `incomplete type`, `function type`, GNU-only `_Alignof(expr)` usage, and unknown/unsupported type cases).
- Iteration 3 slice: preserved helper compatibility by retaining boolean invalid-operand predicates used by `_Generic` and integer-constant-expression evaluation while routing new diagnostics through reason helpers.
- Iteration 3 slice: updated focused sema regressions for `sizeof`/`_Alignof` invalid operand paths to assert exact reason-bearing diagnostics across type-specifier and expression forms.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_alignof_expression_rejected_in_c11 tests.test_sema.SemaTests.test_alignof_expression_rejected_in_c11_ast_path tests.test_sema.SemaTests.test_sizeof_void_type_error tests.test_sema.SemaTests.test_sizeof_atomic_void_type_error tests.test_sema.SemaTests.test_sizeof_incomplete_record_type_error tests.test_sema.SemaTests.test_sizeof_function_type_error tests.test_sema.SemaTests.test_sizeof_function_designator_error tests.test_sema.SemaTests.test_sizeof_void_expression_error tests.test_sema.SemaTests.test_sizeof_incomplete_record_expression_error tests.test_sema.SemaTests.test_alignof_void_type_error tests.test_sema.SemaTests.test_alignof_function_designator_error tests.test_sema.SemaTests.test_alignof_unknown_type_name_error tests.test_sema.SemaTests.test_alignof_unknown_expression_type_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: apply the same reason-specific diagnostic pattern to remaining generic expression-level sema fallbacks (for example cast/sizeof/alignof-adjacent invalid-type paths) where more context improves actionability without overlong errors.
- Iteration 3 slice: upgraded `_Generic` association-type rejection diagnostics in sema from a generic fallback to reason-specific wording (`Invalid generic association type: <reason>`) covering `void type`, `atomic type`, `incomplete type`, and `variably modified type`.
- Iteration 3 slice: added focused sema regression coverage for `_Generic` atomic association rejection and updated existing `_Generic` invalid-association tests to assert exact reason-bearing diagnostics.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_void_association_type_error tests.test_sema.SemaTests.test_generic_selection_atomic_association_type_error tests.test_sema.SemaTests.test_generic_selection_incomplete_record_association_type_error tests.test_sema.SemaTests.test_generic_selection_vla_association_type_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: audit remaining sema generic diagnostics around `_Generic` association matching (`No matching` / duplicate-type conflicts) and decide whether additional context (for example control-type labeling) improves actionability without destabilizing concise baseline messages.
- Iteration 3 slice: upgraded `_Generic` selection diagnostics in sema to preserve resolved type context by reporting duplicate association types as `Duplicate generic association type: '<type>'` and no-match failures as `No matching generic association for control type '<type>'`.
- Iteration 3 slice: updated focused sema regressions for `_Generic` no-match and duplicate-compatible-type rejection paths to lock down the new type-aware diagnostic wording.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_without_match_error tests.test_sema.SemaTests.test_generic_selection_duplicate_compatible_type_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: audit remaining `_Generic` diagnostics for additional context opportunities (for example duplicate `default` association wording and association-type reason labels) while keeping messages concise.
- Iteration 3 slice: upgraded `_Generic` duplicate-default diagnostics in both parser and sema to include the offending association position and explicit single-default rule wording (`Duplicate default generic association at position N: only one default association is allowed`), improving actionability without changing selection semantics.
- Iteration 3 slice: tightened local regression coverage by asserting exact parser and sema duplicate-default diagnostic text for `_Generic` expressions.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_default tests.test_sema.SemaTests.test_generic_selection_duplicate_default_association_error -q` (pass); `.venv/bin/python -m unittest tests.test_parser tests.test_sema -q` (pass).
- Next target: audit remaining `_Generic` parser/sema diagnostics for association-order context opportunities (for example duplicate type associations) while keeping messages concise and stable.
- Iteration 3 slice: upgraded sema `_Generic` no-match diagnostics to include the declared non-default association type list (`available association types: ...`) so control-type mismatches are actionable without rerunning with instrumentation.
- Iteration 3 slice: added focused sema regression coverage for single-association and multi-association no-match paths to lock down stable ordering and message formatting for the new `_Generic` diagnostic.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_without_match_error tests.test_sema.SemaTests.test_generic_selection_without_match_reports_all_association_types -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: audit remaining `_Generic` sema diagnostics for places where association context can be surfaced (for example duplicate-compatible-type diagnostics) without making messages noisy.
- Iteration 3 slice: upgraded parser `_Generic` duplicate-default diagnostics to include both the current and previous default-association positions (`Duplicate default generic association at position N: previous default was at position M; only one default association is allowed`) so parser and sema association-order context now align.
- Iteration 3 slice: updated focused parser regression coverage to assert the new duplicate-default wording for `_Generic` expressions.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_default tests.test_parser -q` (pass).
- Next target: mirror the same association-order context pattern into any remaining parser-side `_Generic` diagnostics that still omit prior-association location details.
- Iteration 3 slice: upgraded parser `_Generic` duplicate-default diagnostics to include the source location of the first default association (`line`/`column`) alongside its association position so duplicate-order context now points to both ordinal and token location.
- Iteration 3 slice: updated focused parser regression coverage to lock down the new `_Generic` duplicate-default diagnostic wording with source-location context.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_default -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Iteration 3 slice: added parser-side `_Generic` duplicate-identical-type detection so repeated association type names (for example `int: ...` followed by `int: ...`) now fail during parsing with association-order and source-location context instead of deferring to sema.
- Iteration 3 slice: added focused parser regression coverage for duplicate identical `_Generic` type associations to lock down the new diagnostic wording (`position`, `line`, and `column` of the first association).
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_default tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_identical_type_association -q` (pass); `.venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: audit `_Generic` parser diagnostics for other parser-detectable association conflicts (beyond duplicate default/identical type names) that can be reported earlier with stable association-order context without duplicating sema compatibility checks.
- Iteration 3 slice: added focused parser regression coverage proving `_Generic` duplicate-type rejection already catches canonical integer spellings (`int` vs `signed int`) at parse time with stable association-order/location diagnostics.
- Iteration 3 slice: repaired sema duplicate-compatible-type regression isolation by constructing the AST directly (instead of re-parsing C source), so sema duplicate-compatibility checks remain covered even when parser-level duplicate detection fires first.
- Checks: `python3.11 -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_identical_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_integer_type_association tests.test_sema.SemaTests.test_generic_selection_duplicate_compatible_type_error -q` (pass); `python3.11 -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_default tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_identical_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_integer_type_association tests.test_sema.SemaTests.test_generic_selection_without_match_error tests.test_sema.SemaTests.test_generic_selection_without_match_reports_all_association_types tests.test_sema.SemaTests.test_generic_selection_duplicate_compatible_type_error -q` (pass).
- Iteration 3 slice: upgraded parser `_Generic` duplicate-type diagnostics to distinguish `identical` vs `canonical-equivalent` duplicate associations by preserving and comparing each association's source spelling; this keeps exact duplicates concise while clarifying when different spellings collapse to the same canonical type.
- Iteration 3 slice: added focused parser regression coverage for canonicalized integer duplicate associations beyond `int`/`signed int` (`long`/`long int` and `unsigned`/`unsigned int`) and updated the existing canonical duplicate assertion to lock down the new `canonical-equivalent` wording.
- Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_identical_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_integer_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_long_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_unsigned_type_association -q` (pass); `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: evaluate typedef-alias `_Generic` duplicate associations (for example `typedef int I; _Generic(x, int: 1, I: 2)`) to decide whether parser-side duplicate detection should stay spelling/canonical-type-only and leave typedef compatibility conflicts to sema diagnostics.
- Iteration 3 slice: upgraded sema `_Alignas` missing-declarator diagnostics to preserve declaration qualifiers by reusing storage-class/`_Thread_local` context (`Invalid alignment specifier for <scope> object declaration without identifier with ...`) instead of emitting context-ambiguous fallback text.
- Iteration 3 slice: added focused sema regressions for file-scope and block-scope `_Alignas` declarations without identifiers that include both `extern` and `_Thread_local`, and updated the existing block-scope tag-only assertion to match the normalized `block-scope object declaration` wording.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_file_scope_storage_without_identifier_error tests.test_sema.SemaTests.test_file_scope_thread_local_without_identifier_error tests.test_sema.SemaTests.test_block_scope_storage_without_identifier_error tests.test_sema.SemaTests.test_block_scope_thread_local_without_identifier_error tests.test_sema.SemaTests.test_alignas_tag_only_declaration_error tests.test_sema.SemaTests.test_alignas_block_scope_tag_only_declaration_error tests.test_sema.SemaTests.test_alignas_file_scope_missing_identifier_reports_qualifiers tests.test_sema.SemaTests.test_alignas_block_scope_missing_identifier_reports_qualifiers -q` (pass).
- Next target: audit remaining sema alignment/declaration diagnostics for other hardcoded missing-declarator wording that can reuse shared qualifier-context helpers without changing semantic behavior.
- Iteration 3 slice: adjusted parser `_Generic` duplicate-type checks to defer associations that reference typedef names to sema, so typedef-alias compatibility conflicts are reported by semantic analysis instead of parse-time canonical duplicate rejection.
- Iteration 3 slice: added focused parser and sema regressions for `typedef int I; _Generic(x, int: 1, I: 2)` to lock down the new split of responsibilities (parser accepts; sema emits duplicate-compatible-type diagnostic).
- Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_allows_typedef_alias_duplicates_for_sema tests.test_sema.SemaTests.test_generic_selection_typedef_alias_duplicate_compatible_type_error tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_integer_type_association tests.test_sema.SemaTests.test_generic_selection_duplicate_compatible_type_error -q` (pass).
- Next target: audit parser-side `_Generic` duplicate detection for other alias-like type-name paths (`typeof`/qualified typedef spellings) that should remain deferred to sema while preserving early parser diagnostics for pure canonical builtin duplicates.
- Iteration 3 slice: audited parser-side `_Generic` duplicate detection for qualified typedef spellings and confirmed parser checks stay limited to canonical builtin spellings while typedef-backed associations remain deferred to sema for compatibility analysis.
- Iteration 3 slice: added focused parser and sema regressions for qualified typedef aliases (`const int` vs `const I`) to lock down this defer-to-sema behavior and duplicate-compatible-type diagnostics.
- Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_allows_qualified_typedef_alias_duplicates_for_sema tests.test_sema.SemaTests.test_generic_selection_qualified_typedef_alias_duplicate_compatible_type_error tests.test_parser.ParserTests.test_generic_selection_allows_typedef_alias_duplicates_for_sema tests.test_sema.SemaTests.test_generic_selection_typedef_alias_duplicate_compatible_type_error -q` (pass).
- Next target: evaluate whether parser-side `_Generic` duplicate detection should also defer GNU `typeof`/`__typeof__` association spellings (once supported) to sema while keeping early canonical-builtin duplicate diagnostics stable.
- Iteration 3 slice: refined sema `_Generic` duplicate-compatible-type diagnostics to include both the current and previous association type labels in-line (`position N ('...')` vs `position M ('...')`), making duplicate reports easier to correlate with source association entries while preserving compatibility semantics.
- Iteration 3 slice: updated focused sema regressions for direct duplicate type associations and typedef-backed duplicate-compatible associations to lock down the new message shape.
- Checks: `.venv/bin/python -m unittest tests.test_sema.SemaTests.test_generic_selection_duplicate_compatible_type_error tests.test_sema.SemaTests.test_generic_selection_typedef_alias_duplicate_compatible_type_error tests.test_sema.SemaTests.test_generic_selection_qualified_typedef_alias_duplicate_compatible_type_error -q` (pass); `.venv/bin/python -m unittest tests.test_sema -q` (pass).
- Next target: extend `_Generic` duplicate-compatible diagnostics with source location context (line/column of the first compatible association) when AST location metadata becomes available in sema.
- Iteration 3 slice: threaded `_Generic` association source coordinates through parser `TypeSpec` metadata and upgraded sema duplicate-compatible-type diagnostics to report the first conflicting association location (`line`/`column`) when available.
- Iteration 3 slice: kept manually-constructed AST coverage stable by emitting the existing location-less duplicate message when association source metadata is absent, and updated typedef-alias sema regressions to lock down the new location-bearing wording.
- Checks: `.venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_allows_typedef_alias_duplicates_for_sema tests.test_parser.ParserTests.test_generic_selection_allows_qualified_typedef_alias_duplicates_for_sema tests.test_sema.SemaTests.test_generic_selection_duplicate_compatible_type_error tests.test_sema.SemaTests.test_generic_selection_typedef_alias_duplicate_compatible_type_error tests.test_sema.SemaTests.test_generic_selection_qualified_typedef_alias_duplicate_compatible_type_error -q` (pass).
- Next target: audit other sema diagnostics that already carry association positions (for example `_Generic` duplicate/default paths) and add source-location context where parser metadata exists without regressing manually-constructed AST tests.
- Iteration 3 slice: upgraded parser `_Generic` duplicate-default diagnostics to include the current duplicate association source location (`line`/`column`) alongside the prior default location, aligning parser-side context density with sema duplicate reports.
- Iteration 3 slice: updated focused parser regression coverage to lock down the new duplicate-default message shape with both current and previous association coordinates.
- Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_default tests.test_parser.ParserTests.test_generic_selection_records_association_source_locations -q` (pass).
- Next target: mirror association location context in any remaining parser `_Generic` duplicate-type diagnostics that still only report prior association coordinates.
- Iteration 3 slice: upgraded parser `_Generic` duplicate-type diagnostics to include the current conflicting association source location (`line`/`column`) in addition to the previous association coordinates, aligning duplicate-type reports with duplicate-default context density.
- Iteration 3 slice: updated focused parser regression assertions for duplicate identical and canonical-equivalent `_Generic` type associations (`int`/`signed int`, `long`/`long int`, `unsigned`/`unsigned int`, `short`/`short int`, and qualifier-order canonicalization) to lock down the new location-bearing message shape.
- Checks: `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_default tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_identical_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_integer_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_long_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_unsigned_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_short_type_association tests.test_parser.ParserTests.test_generic_selection_rejects_duplicate_canonical_qualifier_order_type_association tests.test_parser.ParserTests.test_generic_selection_records_association_source_locations -q` (pass); `PYTHONPATH=src .venv/bin/python -m unittest tests.test_parser -q` (pass).
- Next target: audit parser-side `_Generic` diagnostics for other conflict paths (for example parser-detectable default/type mixups) that can include both current and prior association coordinates without duplicating sema compatibility checks.
